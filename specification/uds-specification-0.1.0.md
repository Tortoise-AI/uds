# Universal Dashboard Specification (UDS)

**Version**: 0.1.0  
**Status**: Draft  
**Last Updated**: January 2026  
**License**: Apache 2.0  
**Canonical URL**: https://uds.dev/spec/0.1.0  
**Copyright**: 2026 Tortoise AI Ltd

---

## Abstract

The Universal Dashboard Specification (UDS) defines a vendor-neutral, declarative format for describing analytical dashboards. UDS enables dashboards to be authored once and rendered across multiple platforms, generated by AI systems, versioned in source control, and evolved through collaborative workflows.

UDS is designed for the AI-native era: dashboards are described in terms of **intent**, **persona**, and **semantic references** rather than pixel-precise layouts and raw queries. This enables intelligent systems to generate, optimise, and adapt dashboards while maintaining human oversight and portability.

---

## Status of This Document

This document specifies the Universal Dashboard Specification version 0.1.0. Distribution of this document is unlimited.

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [BCP 14](https://www.rfc-editor.org/info/bcp14) [RFC 2119](https://www.rfc-editor.org/rfc/rfc2119) [RFC 8174](https://www.rfc-editor.org/rfc/rfc8174) when, and only when, they appear in all capitals, as shown here.

---

## Table of Contents

1. [Introduction](#1-introduction)
2. [Design Principles](#2-design-principles)
3. [Document Format](#3-document-format)
4. [Schema Overview](#4-schema-overview)
5. [Root Object](#5-root-object)
6. [Dashboard Object](#6-dashboard-object)
7. [Persona](#7-persona)
8. [Semantic Sources](#8-semantic-sources)
9. [Temporal Semantics](#9-temporal-semantics)
10. [Data Binding](#10-data-binding)
    - 10.7 [Hybrid Data Binding](#107-hybrid-data-binding)
11. [Derived Metrics](#11-derived-metrics)
12. [Layout System](#12-layout-system)
13. [Panels](#13-panels)
14. [Visualisation Types](#14-visualisation-types)
    - 14.15 [Progress Type](#1415-progress-type)
    - 14.16 [OKR Type](#1416-okr-type)
    - 14.17 [Scorecard Type](#1417-scorecard-type)
    - 14.18 [Roadmap Type](#1418-roadmap-type)
15. [Interactivity](#15-interactivity)
16. [Filters and Variables](#16-filters-and-variables)
17. [Theming](#17-theming)
18. [Internationalisation](#18-internationalisation)
19. [Access Control](#19-access-control)
20. [Alerts and Notifications](#20-alerts-and-notifications)
21. [Embedding](#21-embedding)
22. [Error Handling](#22-error-handling)
23. [AI Generation](#23-ai-generation)
24. [Document Lifecycle](#24-document-lifecycle)
25. [Extension Mechanism](#25-extension-mechanism)
26. [Compilation Targets](#26-compilation-targets)
27. [Security Considerations](#27-security-considerations)
28. [Accessibility](#28-accessibility)
29. [Conformance](#29-conformance)
30. [Versioning](#30-versioning)
31. [IANA Considerations](#31-iana-considerations)
32. [References](#32-references)
33. [Appendix A: Complete JSON Schema](#appendix-a-complete-json-schema)
34. [Appendix B: Examples](#appendix-b-examples)
35. [Appendix C: Migration Guides](#appendix-c-migration-guides)
36. [Appendix D: Glossary](#appendix-d-glossary)
37. [Appendix E: Conformance Level Enumeration](#appendix-e-conformance-level-enumeration)

---

## 1. Introduction

### 1.1 Purpose

Analytical dashboards are critical infrastructure for data-driven organisations. Yet dashboards remain trapped in proprietary formats that create vendor lock-in, prevent AI-powered generation, and inhibit treating dashboards as versionable, testable software assets.

The Universal Dashboard Specification addresses these limitations by providing:

1. **A common language** for describing dashboards independent of rendering platform
2. **Semantic-first design** that references business metrics rather than raw queries
3. **Intent declaration** that captures why a dashboard exists and what decisions it enables
4. **Persona awareness** enabling dashboards to adapt to user roles
5. **AI generation support** with explicit constraints and preferences
6. **Compilation targets** for multiple rendering platforms
7. **Lifecycle management** for versioning, deprecation, and migration

### 1.2 Scope

This specification defines:

- The structure and semantics of UDS documents
- Required and optional properties for all objects
- Validation rules and constraints
- Error handling behaviour
- Conformance requirements for implementations

This specification does NOT define:

- How dashboards are rendered (implementation-specific)
- How data is queried (delegated to semantic layer)
- How users authenticate (delegated to platform)
- Visual design tokens (delegated to theme specifications)
- Network protocols for data transport

### 1.3 Relationship to Other Specifications

| Specification | Relationship |
|--------------|--------------|
| **JSON Schema Draft 2020-12** | UDS documents are validated against JSON Schema |
| **Vega-Lite 5.x** | UDS visualisations MAY compile to Vega-Lite |
| **Open Semantic Interchange (OSI)** | UDS semantic bindings align with OSI metric definitions |
| **OpenAPI 3.1** | UDS documents MAY reference OpenAPI-defined data sources |
| **WCAG 2.1 Level AA** | UDS accessibility requirements derive from WCAG |
| **BCP 47** | Language tags follow BCP 47 |
| **ISO 8601** | Date and time formats follow ISO 8601 |
| **ISO 4217** | Currency codes follow ISO 4217 |

### 1.4 Terminology

See [Appendix D: Glossary](#appendix-d-glossary) for definitions of terms used throughout this specification.

---

## 2. Design Principles

UDS is built on eight core principles. These principles guide all design decisions and SHOULD guide implementation decisions.

### 2.1 Declarative Over Imperative

Dashboards declare **what** should be displayed, not **how** to display it. Implementation details are delegated to renderers.

```yaml
# CORRECT: Declarative intent
- type: trend
  metric: revenue
  emphasis: growth_rate

# AVOID: Imperative instructions
- type: line_chart
  x_axis_format: "%Y-%m"
  line_color: "#4CAF50"
  line_width: 2px
```

### 2.2 Semantic References Over Raw Queries

Dashboards reference metrics and dimensions defined in a semantic layer. Raw SQL, API calls, or data transformations are not permitted in UDS documents.

```yaml
# CORRECT: Semantic reference
metric:
  ref: "sales.total_revenue"

# NOT PERMITTED: Raw query
query: "SELECT SUM(amount) FROM orders"
```

**Rationale**: Semantic references enable consistent metrics, governance, lineage tracking, and improved AI accuracy.

### 2.3 Intent is Required

Every dashboard MUST declare its purpose. This enables AI systems to evaluate generated dashboards, helps humans understand rationale, and supports governance.

```yaml
dashboard:
  intent: "Monitor Q4 revenue performance against targets"
  decisions:
    - "Adjust quarterly forecast"
    - "Reallocate sales resources by region"
```

### 2.4 Persona Awareness

Dashboards declare their intended audience. Renderers adapt presentation based on persona characteristics.

### 2.5 Progressive Disclosure

Complex information is revealed progressively. Initial views show essential metrics; detail is available through interaction.

### 2.6 Portability by Default

UDS documents MUST be renderable by any conformant implementation. Platform-specific features are isolated in extension namespaces.

### 2.7 Accessibility as Requirement

Accessibility is not optional. UDS documents MUST provide sufficient information for accessible rendering. Conformant renderers MUST meet WCAG 2.1 Level AA.

### 2.8 Fail Gracefully

When errors occur, dashboards MUST remain usable. Error handling behaviour is explicitly specified, not left to implementation.

---

## 3. Document Format

### 3.1 File Format

UDS documents MUST be valid YAML 1.2 or JSON (RFC 8259). 

- YAML is RECOMMENDED for human authoring
- JSON is RECOMMENDED for machine generation and API transport

Implementations MUST support both formats.

**File extensions**:
- `.uds.yaml` or `.uds.yml` for YAML
- `.uds.json` for JSON

**Media types**:
- `application/vnd.uds+yaml` for YAML
- `application/vnd.uds+json` for JSON

### 3.2 Character Encoding

UDS documents MUST be encoded in UTF-8 without byte order mark (BOM).

### 3.3 Document Size

Implementations MUST support documents up to 10 MB. Implementations MAY support larger documents.

### 3.4 Comments

YAML comments (lines beginning with `#`) are permitted and SHOULD be preserved by tooling. 

JSON does not support comments. Implementations MUST NOT accept JSON documents containing comments.

### 3.5 Whitespace

Leading and trailing whitespace in string values MUST be preserved. Implementations MUST NOT normalise whitespace except where explicitly specified.

---

## 4. Schema Overview

### 4.1 Document Structure

Every UDS document is a single root object containing:

```yaml
uds: "0.1.0"                    # REQUIRED: Specification version
$schema: "..."                  # RECOMMENDED: JSON Schema URI
metadata: { }                   # OPTIONAL: Document metadata
dashboard: { }                  # REQUIRED: Dashboard definition
extensions: { }                 # OPTIONAL: Platform-specific extensions
```

### 4.2 Property Naming

All property names:
- MUST be ASCII lowercase letters, digits, or underscores
- MUST begin with a letter
- MUST NOT exceed 64 characters
- MUST use `snake_case` (not `camelCase` or `kebab-case`)

### 4.3 Null Values

Properties with `null` values are equivalent to omitted properties, unless explicitly specified otherwise.

### 4.4 Unknown Properties

Implementations MUST ignore unknown properties at the root level and within `extensions`. Implementations SHOULD warn when unknown properties are encountered elsewhere.

---

## 5. Root Object

### 5.1 Properties

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `uds` | string | REQUIRED | Specification version (semver) |
| `$schema` | string (URI) | RECOMMENDED | JSON Schema URI for validation |
| `metadata` | Metadata Object | OPTIONAL | Document metadata |
| `dashboard` | Dashboard Object | REQUIRED | Dashboard definition |
| `extensions` | object | OPTIONAL | Platform-specific extensions |

### 5.2 uds Property

The `uds` property declares the specification version. The value MUST be a valid semantic version string matching the pattern:

```
^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)$
```

Implementations MUST reject documents with unsupported specification versions.

### 5.3 Metadata Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | Identifier | OPTIONAL | Unique document identifier |
| `name` | string | OPTIONAL | Machine-readable name |
| `created_at` | datetime | OPTIONAL | Creation timestamp |
| `modified_at` | datetime | OPTIONAL | Last modification timestamp |
| `version` | string | OPTIONAL | Document version (user-defined) |
| `authors` | Author[] | OPTIONAL | Document authors |
| `tags` | string[] | OPTIONAL | Categorisation tags |
| `changelog` | ChangelogEntry[] | OPTIONAL | Version history |
| `annotations` | object | OPTIONAL | Arbitrary key-value annotations |

**Example**:

```yaml
metadata:
  id: "d290f1ee-6c54-4b01-90e6-d701748f0851"
  name: "sales-executive-q4"
  created_at: "2026-01-10T14:30:00Z"
  modified_at: "2026-01-11T09:15:00Z"
  version: "2.3.1"
  authors:
    - name: "Data Team"
      email: "data@example.com"
  tags:
    - "sales"
    - "executive"
    - "quarterly"
  changelog:
    - version: "2.3.1"
      date: "2026-01-11"
      author: "jane.smith"
      changes:
        - "Added regional breakdown panel"
    - version: "2.3.0"
      date: "2026-01-05"
      author: "john.doe"
      changes:
        - "Restructured KPI section"
  annotations:
    cost_centre: "CC-1234"
    data_classification: "internal"
```

---

## 6. Dashboard Object

The Dashboard object is the primary container for all dashboard content.

### 6.1 Properties

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `title` | string | REQUIRED | Human-readable title (max 200 chars) |
| `description` | string | RECOMMENDED | Extended description (max 2000 chars) |
| `intent` | string | REQUIRED | Purpose of this dashboard (max 500 chars) |
| `decisions` | string[] | RECOMMENDED | Decisions this dashboard enables |
| `persona` | Persona | REQUIRED | Target user persona |
| `semantic_sources` | SemanticSource[] | REQUIRED | Data source connections |
| `time_context` | TimeContext | OPTIONAL | Default time configuration |
| `layout` | Layout | REQUIRED | Panel arrangement |
| `panels` | Panel[] | REQUIRED | Dashboard content (min 1) |
| `derived_metrics` | DerivedMetric[] | OPTIONAL | Computed metrics |
| `filters` | Filter[] | OPTIONAL | Global filters |
| `variables` | Variable[] | OPTIONAL | User-configurable variables |
| `refresh` | Refresh | OPTIONAL | Auto-refresh configuration |
| `access` | Access | OPTIONAL | Access control rules |
| `alerts` | Alert[] | OPTIONAL | Alert definitions |
| `theme` | Theme | OPTIONAL | Theme configuration |
| `i18n` | I18n | OPTIONAL | Internationalisation |
| `embedding` | Embedding | OPTIONAL | Embedding configuration |
| `error_handling` | ErrorHandling | OPTIONAL | Error behaviour |
| `lifecycle` | Lifecycle | OPTIONAL | Document lifecycle |
| `generation` | Generation | OPTIONAL | AI generation configuration |

### 6.2 Complete Example

```yaml
uds: "0.1.0"
$schema: "https://uds.dev/schema/0.1.0/dashboard.json"

metadata:
  id: "sales-exec-q4-2026"
  version: "1.0.0"

dashboard:
  title: "Executive Sales Overview"
  description: "High-level sales performance for leadership review"
  
  intent: "Enable executives to monitor Q4 revenue and identify regions requiring intervention"
  decisions:
    - "Approve or adjust quarterly forecast"
    - "Allocate additional resources to underperforming regions"
    - "Escalate accounts requiring executive attention"
  
  persona:
    type: executive
  
  semantic_sources:
    - id: sales
      type: cube
      endpoint: "https://cube.example.com/cubejs-api/v1"
  
  time_context:
    default_range:
      preset: current_quarter
    timezone:
      mode: user_local
    comparison:
      enabled: true
      default: previous_quarter
  
  layout:
    type: grid
    columns: 12
    row_height: 80
    gap: 16
  
  panels:
    - id: revenue_kpi
      type: kpi
      title: "Total Revenue"
      position: { row: 0, column: 0, width: 3, height: 2 }
      data:
        source: sales
        metrics:
          - ref: "sales.total_revenue"
  
  theme:
    ref: "corporate-light"
```

---

## 7. Persona

The Persona declares the intended audience for the dashboard. Renderers SHOULD adapt presentation based on persona characteristics.

### 7.1 Persona Object Properties

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `type` | string | REQUIRED | Persona type identifier |
| `characteristics` | Characteristics | OPTIONAL | Explicit characteristics (overrides type defaults) |

### 7.2 Built-in Persona Types

UDS defines five built-in persona types. Implementations MUST support these types.

| Type | Description | Default Characteristics |
|------|-------------|------------------------|
| `executive` | C-suite, senior leadership | brief attention, low data literacy, minimal interaction |
| `manager` | Department/team managers | moderate attention, medium data literacy, moderate interaction |
| `analyst` | Data/business analysts | extended attention, high data literacy, full interaction |
| `operator` | Operations, front-line staff | brief attention, low data literacy, action-focused |
| `external` | Customers, partners | moderate attention, low data literacy, curated content |

### 7.3 Characteristics Object

| Property | Type | Values | Description |
|----------|------|--------|-------------|
| `attention_span` | string | `brief`, `moderate`, `extended` | Expected viewing duration |
| `data_literacy` | string | `low`, `medium`, `high` | Statistical/analytical sophistication |
| `interaction_preference` | string | `minimal`, `moderate`, `full` | Desired interactivity level |
| `primary_device` | string | `desktop`, `tablet`, `mobile`, `any` | Primary viewing device |
| `primary_concern` | string | any | Domain-specific focus area |
| `update_frequency` | string | `realtime`, `frequent`, `periodic`, `on_demand` | How often user checks dashboard |

### 7.4 Custom Personas

Custom personas are defined using `type: custom` with explicit characteristics:

```yaml
persona:
  type: custom
  id: "compliance_officer"
  name: "Compliance Officer"
  characteristics:
    attention_span: extended
    data_literacy: medium
    interaction_preference: full
    primary_concern: "audit_trail"
    update_frequency: periodic
```

Custom persona identifiers:
- MUST match pattern `^[a-z][a-z0-9_]*$`
- MUST NOT conflict with built-in types
- SHOULD be documented in organisation's UDS style guide

### 7.5 Persona-Driven Rendering

Renderers SHOULD adapt based on persona:

| Characteristic | Rendering Adaptation |
|---------------|---------------------|
| `attention_span: brief` | Fewer panels, larger KPIs, no exploration |
| `data_literacy: low` | Simple charts, contextual explanations, no raw numbers |
| `interaction_preference: minimal` | Disable drill-down, hide filters, no configuration |
| `primary_device: mobile` | Single-column layout, touch-optimised |

---

## 8. Semantic Sources

Semantic sources connect the dashboard to one or more semantic layer endpoints.

### 8.1 SemanticSource Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | Identifier | REQUIRED | Unique source identifier |
| `type` | string | REQUIRED | Source type |
| `endpoint` | string (URI) | REQUIRED | API endpoint |
| `authentication` | Authentication | OPTIONAL | Auth configuration |
| `capabilities` | Capabilities | OPTIONAL | Source capabilities (for custom types) |
| `options` | object | OPTIONAL | Type-specific options |

### 8.2 Source Types

| Type | Description | Required Capabilities |
|------|-------------|----------------------|
| `cube` | Cube semantic layer | metrics, dimensions, filters, time_grains |
| `dbt` | dbt Semantic Layer | metrics, dimensions, filters |
| `looker` | Looker/LookML | metrics, dimensions, filters |
| `atscale` | AtScale | metrics, dimensions, filters, mdx |
| `custom` | Custom implementation | declared in capabilities |

### 8.3 Authentication Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `type` | string | REQUIRED | `none`, `bearer`, `api_key`, `oauth2`, `custom` |
| `token_env` | string | CONDITIONAL | Environment variable containing token |
| `header_name` | string | OPTIONAL | Custom header name (default varies by type) |
| `oauth2` | OAuth2Config | CONDITIONAL | OAuth2 configuration |

**Security Note**: Authentication credentials MUST NOT be stored in UDS documents. Use environment variable references.

```yaml
semantic_sources:
  - id: primary
    type: cube
    endpoint: "https://cube.example.com/cubejs-api/v1"
    authentication:
      type: bearer
      token_env: "CUBE_API_TOKEN"
    options:
      timeout: 30000
      retry:
        attempts: 3
        backoff: exponential

  - id: warehouse
    type: custom
    endpoint: "https://api.internal.example.com/semantic/v2"
    authentication:
      type: api_key
      token_env: "WAREHOUSE_API_KEY"
      header_name: "X-API-Key"
    capabilities:
      metrics: true
      dimensions: true
      filters: true
      time_grains:
        - day
        - week
        - month
        - quarter
        - year
      supports_comparison: true
      supports_percentiles: false
      max_dimensions: 5
      max_metrics: 10
```

### 8.4 Capabilities Object (for custom sources)

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `metrics` | boolean | REQUIRED | Supports metric queries |
| `dimensions` | boolean | REQUIRED | Supports dimensional grouping |
| `filters` | boolean | REQUIRED | Supports filter predicates |
| `time_grains` | string[] | REQUIRED | Supported time granularities |
| `supports_comparison` | boolean | OPTIONAL | Supports period-over-period |
| `supports_percentiles` | boolean | OPTIONAL | Supports percentile calculations |
| `supports_cumulative` | boolean | OPTIONAL | Supports running totals |
| `max_dimensions` | integer | OPTIONAL | Maximum dimensions per query |
| `max_metrics` | integer | OPTIONAL | Maximum metrics per query |
| `max_rows` | integer | OPTIONAL | Maximum result rows |

---

## 9. Temporal Semantics

Time is the most complex aspect of analytical dashboards. This section defines precise semantics for temporal operations.

### 9.1 TimeContext Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `default_range` | TimeRange | OPTIONAL | Default time selection |
| `timezone` | TimezoneConfig | REQUIRED | Timezone handling |
| `boundaries` | Boundaries | OPTIONAL | Period boundary definitions |
| `comparison` | ComparisonConfig | OPTIONAL | Period comparison settings |
| `granularity` | GranularityConfig | OPTIONAL | Time granularity settings |
| `incomplete_periods` | IncompletePeriodConfig | OPTIONAL | Partial period handling |

### 9.2 TimezoneConfig Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `mode` | string | REQUIRED | `user_local`, `source`, `utc`, `explicit` |
| `explicit` | string | CONDITIONAL | IANA timezone (required if mode is `explicit`) |
| `display_mode` | string | OPTIONAL | `convert`, `label`, `both` |

**Timezone Modes**:

- `user_local`: Convert all times to user's browser/device timezone
- `source`: Display times in the timezone stored in the data
- `utc`: Convert and display all times in UTC
- `explicit`: Convert all times to the specified IANA timezone

```yaml
time_context:
  timezone:
    mode: explicit
    explicit: "Europe/London"
    display_mode: both  # Show time and timezone label
```

### 9.3 Boundaries Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `day_start` | string | OPTIONAL | Day boundary time (default: "00:00:00") |
| `week_start` | string | OPTIONAL | First day of week (default: "monday") |
| `fiscal_year_start` | string | OPTIONAL | Fiscal year start (MM-DD format) |
| `fiscal_quarter_months` | integer[] | OPTIONAL | Months starting each fiscal quarter |

```yaml
boundaries:
  day_start: "00:00:00"
  week_start: monday          # monday | sunday | saturday
  fiscal_year_start: "04-01"  # April 1st
  fiscal_quarter_months: [4, 7, 10, 1]  # Q1=Apr, Q2=Jul, Q3=Oct, Q4=Jan
```

### 9.4 TimeRange Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `preset` | string | CONDITIONAL | Preset identifier |
| `start` | date/datetime | CONDITIONAL | Explicit start |
| `end` | date/datetime | CONDITIONAL | Explicit end |
| `relative` | RelativeRange | CONDITIONAL | Relative range |

One of `preset`, explicit `start`/`end`, or `relative` MUST be provided.

**Built-in Presets**:

| Preset | Description |
|--------|-------------|
| `today` | Current day |
| `yesterday` | Previous day |
| `this_week` | Current week (per boundaries.week_start) |
| `last_week` | Previous complete week |
| `last_7_days` | Rolling 7 days including today |
| `last_14_days` | Rolling 14 days including today |
| `last_30_days` | Rolling 30 days including today |
| `last_90_days` | Rolling 90 days including today |
| `this_month` | Current calendar month |
| `last_month` | Previous complete calendar month |
| `this_quarter` | Current quarter (calendar or fiscal) |
| `last_quarter` | Previous complete quarter |
| `this_year` | Current year (calendar or fiscal) |
| `last_year` | Previous complete year |
| `current_quarter` | Alias for this_quarter |
| `previous_quarter` | Alias for last_quarter |
| `year_to_date` | January 1 to today (or fiscal equivalent) |
| `quarter_to_date` | Quarter start to today |
| `month_to_date` | Month start to today |
| `week_to_date` | Week start to today |
| `all_time` | All available data |

**Relative Range**:

```yaml
time_range:
  relative:
    value: -90
    unit: days        # days | weeks | months | quarters | years
    anchor: today     # today | start_of_week | start_of_month | start_of_quarter | start_of_year
    inclusive: true   # Include anchor day
```

**Explicit Range**:

```yaml
time_range:
  start: "2025-10-01"
  end: "2025-12-31"
  # Dates are inclusive on both ends
  # Times default to start-of-day for start, end-of-day for end
```

### 9.5 ComparisonConfig Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `enabled` | boolean | REQUIRED | Enable period comparison |
| `default` | string | OPTIONAL | Default comparison type |
| `options` | string[] | OPTIONAL | Available comparison options |
| `alignment` | string | OPTIONAL | `calendar` or `rolling` |

**Comparison Types**:

| Type | Description |
|------|-------------|
| `previous_period` | Same duration immediately prior |
| `previous_week` | Same days in previous week |
| `previous_month` | Same days in previous month |
| `previous_quarter` | Same days in previous quarter |
| `previous_year` | Same days in previous year |
| `custom` | User-defined comparison range |

**Alignment**:

- `calendar`: "Last 30 days" compares to the 30 days before that
- `rolling`: "Last 30 days" compares to same calendar dates last year

```yaml
comparison:
  enabled: true
  default: previous_period
  options:
    - previous_period
    - previous_year
  alignment: calendar
```

### 9.6 IncompletePeriodConfig Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `current_period` | string | OPTIONAL | `include`, `exclude`, `annotate` |
| `annotation_text` | string | OPTIONAL | Text for partial period annotation |
| `projection` | ProjectionConfig | OPTIONAL | Project incomplete periods |

```yaml
incomplete_periods:
  current_period: annotate
  annotation_text: "Partial data - period in progress"
  projection:
    enabled: true
    method: linear      # linear | average | none
    confidence_display: true
```

---

## 10. Data Binding

Data binding connects panels to semantic layer queries.

### 10.1 DataBinding Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `source` | string | REQUIRED | Semantic source ID |
| `metrics` | MetricRef[] | REQUIRED | Metrics to query (min 1) |
| `dimensions` | DimensionRef[] | OPTIONAL | Grouping dimensions |
| `filters` | FilterExpression[] | OPTIONAL | Query filters |
| `sort` | SortSpec[] | OPTIONAL | Result ordering |
| `limit` | integer | OPTIONAL | Maximum rows (default: 1000) |
| `time_range` | TimeRangeBinding | OPTIONAL | Time range for this query |
| `comparison` | boolean | OPTIONAL | Include comparison period |

### 10.2 MetricRef Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `ref` | string | REQUIRED | Semantic layer metric reference |
| `alias` | string | OPTIONAL | Display name override |
| `format` | Format | OPTIONAL | Format override |
| `transform` | string | OPTIONAL | Post-query transformation |

**Metric Reference Format**:

```
<source>.<category>.<metric_name>
```

If source matches the `source` property, it MAY be omitted:

```yaml
# Full reference
ref: "sales.orders.total_revenue"

# Short reference (when source is "sales")
ref: "orders.total_revenue"
```

**Transforms**:

| Transform | Description |
|-----------|-------------|
| `running_total` | Cumulative sum |
| `percent_of_total` | Percentage of grand total |
| `percent_of_group` | Percentage of group total |
| `rank` | Rank within result set |
| `dense_rank` | Dense rank (no gaps) |
| `percentile` | Percentile position |
| `z_score` | Standard deviations from mean |
| `moving_average` | N-period moving average |
| `period_over_period` | Change from previous period |
| `year_over_year` | Change from same period last year |

```yaml
metrics:
  - ref: "sales.total_revenue"
    alias: "Revenue"
    format:
      style: currency
      currency: USD
    
  - ref: "sales.total_revenue"
    alias: "Revenue (Running)"
    transform: running_total
    
  - ref: "sales.total_revenue"
    alias: "% of Total"
    transform: percent_of_total
    format:
      style: percent
      precision: 1
```

### 10.3 DimensionRef Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `ref` | string | REQUIRED | Semantic layer dimension reference |
| `alias` | string | OPTIONAL | Display name override |
| `granularity` | string | OPTIONAL | Time granularity (for temporal dimensions) |
| `sort` | string | OPTIONAL | `alpha`, `metric`, `natural`, `custom` |
| `limit` | integer | OPTIONAL | Top N values |
| `other` | string | OPTIONAL | `group`, `hide`, `show` |
| `bin` | BinConfig | OPTIONAL | Numeric binning |

```yaml
dimensions:
  - ref: "time.order_date"
    granularity: month
    
  - ref: "geography.region"
    sort: metric            # Sort by first metric value
    limit: 10
    other: group            # Group remaining into "Other"
    
  - ref: "orders.amount"
    bin:
      method: equal_width   # equal_width | equal_count | custom
      count: 10
      custom_breaks: [0, 100, 500, 1000, 5000, 10000]
```

### 10.4 FilterExpression Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `dimension` | string | CONDITIONAL | Dimension to filter |
| `metric` | string | CONDITIONAL | Metric to filter |
| `operator` | string | REQUIRED | Comparison operator |
| `value` | any | CONDITIONAL | Single value |
| `values` | any[] | CONDITIONAL | Multiple values |
| `expression` | string | CONDITIONAL | Complex expression |

One of `dimension`, `metric`, or `expression` MUST be provided.

**Operators**:

| Operator | Description | Valid For |
|----------|-------------|-----------|
| `eq` | Equals | all types |
| `neq` | Not equals | all types |
| `gt` | Greater than | numeric, date |
| `gte` | Greater than or equal | numeric, date |
| `lt` | Less than | numeric, date |
| `lte` | Less than or equal | numeric, date |
| `in` | In list | all types |
| `not_in` | Not in list | all types |
| `contains` | Contains substring | string |
| `not_contains` | Does not contain | string |
| `starts_with` | Starts with | string |
| `ends_with` | Ends with | string |
| `matches` | Regex match | string |
| `is_null` | Is null | all types |
| `is_not_null` | Is not null | all types |
| `between` | Between two values | numeric, date |
| `not_between` | Not between | numeric, date |

```yaml
filters:
  # Simple equality
  - dimension: "product.category"
    operator: eq
    value: "Electronics"

  # Multiple values
  - dimension: "geography.region"
    operator: in
    values: ["EMEA", "APAC"]

  # Numeric range
  - metric: "sales.total_revenue"
    operator: gte
    value: 10000

  # Between
  - dimension: "orders.amount"
    operator: between
    values: [100, 1000]

  # Complex expression
  - expression: |
      (product.category = 'Electronics' AND sales.total_revenue > 10000)
      OR product.is_flagship = true
```

### 10.5 Multi-Metric Query Semantics

When multiple metrics are specified with different dimensional requirements, the following rules apply:

1. **Common dimensions**: All specified dimensions are applied to all metrics
2. **Incompatible dimensions**: Renderer SHOULD execute separate queries and align results
3. **Missing values**: Display as null (not zero)

```yaml
# This query:
data:
  source: sales
  metrics:
    - ref: "sales.total_revenue"     # Works with all dimensions
    - ref: "customers.churn_rate"    # Works only with customer dimensions
  dimensions:
    - ref: "time.month"
    - ref: "customer.segment"

# Produces two aligned queries:
# Query 1: total_revenue BY time.month, customer.segment
# Query 2: churn_rate BY time.month, customer.segment
```

### 10.6 TimeRangeBinding

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `inherit` | string | CONDITIONAL | `dashboard` to inherit from dashboard |
| `override` | TimeRange | CONDITIONAL | Explicit override |
| `offset` | RelativeOffset | OPTIONAL | Offset from inherited range |

```yaml
# Inherit from dashboard
time_range:
  inherit: dashboard

# Override completely
time_range:
  override:
    preset: last_12_months

# Inherit with offset (show previous year for comparison)
time_range:
  inherit: dashboard
  offset:
    value: -1
    unit: years
```

---

### 10.7 Hybrid Data Binding

### 2.1 Rationale

Standard UDS panel types (bar, trend, table) work with arbitrary metrics and dimensions. The semantic layer defines the data; UDS binds it to visual elements.

Goal-oriented types (OKR, scorecard, roadmap) require specific data structures: hierarchies, targets, progress metrics, status fields. Without guidance, implementations will fragment.

The hybrid pattern provides:

1. **Structural requirements** (normative): What roles must be filled
2. **Flexible binding** (normative): How to map any semantic layer structure to those roles
3. **Reference models** (informative): Suggested semantic layer structures

### 2.2 Pattern Structure

```yaml
type: <goal-oriented-type>

# Standard data block - what to query
data:
  source: <semantic_source_id>
  metrics:
    - ref: "<metric.refs>"
  dimensions:
    - ref: "<dimension.refs>"
  filters:
    - dimension: "<dimension>"
      operator: eq
      value: "<value>"

# Type-specific options with bindings
options:
  bindings:
    <role>: "<semantic.reference>"
```

### 2.3 Binding Validation

Implementations MUST validate bindings:

1. All REQUIRED roles have bindings
2. Bound references exist in `data.metrics` or `data.dimensions`
3. Bound references resolve to correct types (metric for numeric roles, dimension for categorical)
4. Parent references are valid (e.g., `key_result_objective_id` references valid `objective_id` values)

### 2.4 Error Messages

When bindings are invalid, implementations SHOULD provide specific errors:

```
UDS-E020: Missing required binding 'objective_title' for panel type 'okr'
UDS-E021: Binding 'progress' references 'goals.completion' which is not in data.metrics
UDS-E022: Binding 'objective_id' should reference a dimension, but 'goals.obj_count' is a metric
UDS-E023: Binding 'key_result_objective_id' references invalid parent values
```

### 2.5 New Error Codes

Add to Section 22.5:

| Code | Name | Description |
|------|------|-------------|
| `UDS-E020` | MISSING_BINDING | Required binding not provided |
| `UDS-E021` | BINDING_NOT_IN_DATA | Binding references field not in data block |
| `UDS-E022` | BINDING_TYPE_MISMATCH | Binding references wrong field type |
| `UDS-E023` | BINDING_INVALID_PARENT | Parent reference binding has invalid values |
| `UDS-E024` | BINDING_CIRCULAR | Circular parent reference detected |

## 11. Derived Metrics

Derived metrics are computed from semantic layer metrics within the dashboard.

### 11.1 DerivedMetric Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | Identifier | REQUIRED | Unique identifier |
| `name` | string | REQUIRED | Display name |
| `description` | string | OPTIONAL | Metric description |
| `expression` | Expression | REQUIRED | Calculation expression |
| `format` | Format | OPTIONAL | Display format |

### 11.2 Expression Types

**Arithmetic Expression**:

```yaml
derived_metrics:
  - id: revenue_per_employee
    name: "Revenue per Employee"
    expression:
      type: arithmetic
      operator: divide        # add | subtract | multiply | divide
      operands:
        - ref: "sales.total_revenue"
        - ref: "hr.employee_count"
    format:
      style: currency
      currency: USD
```

**Conditional Expression**:

```yaml
derived_metrics:
  - id: emea_revenue
    name: "EMEA Revenue"
    expression:
      type: conditional
      metric:
        ref: "sales.total_revenue"
      condition:
        dimension: "geography.region"
        operator: eq
        value: "EMEA"
```

**Window Expression**:

```yaml
derived_metrics:
  - id: revenue_3m_avg
    name: "3-Month Average Revenue"
    expression:
      type: window
      function: average       # sum | average | min | max | count
      metric:
        ref: "sales.total_revenue"
      window:
        type: rolling
        size: 3
        unit: months
```

**Case Expression**:

```yaml
derived_metrics:
  - id: performance_tier
    name: "Performance Tier"
    expression:
      type: case
      cases:
        - when:
            metric: "sales.quota_attainment"
            operator: gte
            value: 1.2
          then: "Exceeding"
        - when:
            metric: "sales.quota_attainment"
            operator: gte
            value: 1.0
          then: "Meeting"
        - when:
            metric: "sales.quota_attainment"
            operator: gte
            value: 0.8
          then: "Approaching"
      else: "Below"
```

### 11.3 Using Derived Metrics

Derived metrics are referenced with the `derived:` prefix:

```yaml
panels:
  - id: efficiency_kpi
    type: kpi
    data:
      source: sales
      metrics:
        - ref: "derived:revenue_per_employee"
```

---

## 12. Layout System

### 12.1 Layout Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `type` | string | REQUIRED | `grid`, `sections`, `tabs`, `flow` |
| `columns` | integer | CONDITIONAL | Grid columns (for grid type) |
| `row_height` | integer | OPTIONAL | Base row height in pixels |
| `gap` | integer | OPTIONAL | Gap between panels in pixels |
| `padding` | Padding | OPTIONAL | Container padding |
| `max_width` | integer | OPTIONAL | Maximum layout width |
| `breakpoints` | Breakpoints | OPTIONAL | Responsive breakpoints |
| `sections` | Section[] | CONDITIONAL | Section definitions (for sections type) |
| `tabs` | Tab[] | CONDITIONAL | Tab definitions (for tabs type) |

### 12.2 Grid Layout

The default 12-column grid system:

```yaml
layout:
  type: grid
  columns: 12
  row_height: 80
  gap: 16
  padding:
    top: 24
    right: 24
    bottom: 24
    left: 24
  max_width: 1920
  
  breakpoints:
    large:
      min_width: 1200
      columns: 12
    medium:
      min_width: 768
      columns: 8
    small:
      min_width: 0
      columns: 4
```

### 12.3 Position Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `row` | integer | REQUIRED | Grid row (0-indexed) |
| `column` | integer | REQUIRED | Grid column (0-indexed) |
| `width` | integer | REQUIRED | Column span |
| `height` | integer | REQUIRED | Row span |
| `z_index` | integer | OPTIONAL | Stacking order (default: 0) |
| `responsive` | ResponsivePosition | OPTIONAL | Responsive overrides |

**Position Rules**:

1. `row` and `column` are 0-indexed
2. `width` MUST be between 1 and `layout.columns`
3. `height` MUST be at least 1
4. Panels MUST NOT overlap unless `z_index` differs
5. When `row: auto`, panel flows after previous panel

```yaml
position:
  row: 0
  column: 0
  width: 4
  height: 2
  
  responsive:
    medium:
      width: 4
      height: 2
    small:
      row: auto          # Auto-flow on mobile
      column: 0
      width: 4           # Full width on 4-column grid
      height: 2
```

### 12.4 Sections Layout

```yaml
layout:
  type: sections
  gap: 24
  
  sections:
    - id: summary
      title: "Executive Summary"
      description: "Key metrics at a glance"
      collapsible: true
      collapsed: false
      layout:
        type: grid
        columns: 12
      panels:
        - revenue_kpi
        - orders_kpi
        - conversion_kpi

    - id: trends
      title: "Performance Trends"
      collapsible: true
      collapsed: false
      layout:
        type: grid
        columns: 12
      panels:
        - revenue_trend
        - regional_breakdown

    - id: details
      title: "Detailed Breakdown"
      collapsible: true
      collapsed: true    # Collapsed by default
      layout:
        type: grid
        columns: 12
      panels:
        - detail_table
```

### 12.5 Tabs Layout

```yaml
layout:
  type: tabs
  position: top           # top | left | bottom
  
  tabs:
    - id: overview
      title: "Overview"
      icon: "dashboard"
      layout:
        type: grid
        columns: 12
      panels:
        - kpi_row
        - main_trend

    - id: regional
      title: "By Region"
      icon: "map"
      layout:
        type: grid
        columns: 12
      panels:
        - region_map
        - region_table

    - id: products
      title: "Products"
      icon: "inventory"
      badge:
        type: count
        value: 5
        status: warning
      layout:
        type: grid
        columns: 12
      panels:
        - product_performance
```

### 12.6 Flow Layout

For simple, auto-flowing layouts:

```yaml
layout:
  type: flow
  direction: vertical     # vertical | horizontal
  wrap: true
  gap: 16
  item_min_width: 300
  item_max_width: 600
```

---

## 13. Panels

Panels are the fundamental content units within a dashboard.

### 13.1 Panel Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | Identifier | REQUIRED | Unique panel identifier |
| `type` | string | REQUIRED | Visualisation type |
| `title` | string | RECOMMENDED | Panel title (max 100 chars) |
| `description` | string | OPTIONAL | Extended description for accessibility |
| `position` | Position | REQUIRED | Grid position |
| `data` | DataBinding | REQUIRED | Data configuration |
| `options` | object | OPTIONAL | Type-specific options |
| `disclosure` | Disclosure | OPTIONAL | Information density level |
| `interactions` | Interaction[] | OPTIONAL | User interaction handlers |
| `conditional` | Conditional | OPTIONAL | Conditional display rules |
| `error_handling` | PanelErrorHandling | OPTIONAL | Error behaviour override |
| `accessibility` | PanelAccessibility | OPTIONAL | Accessibility overrides |
| `cache` | CacheConfig | OPTIONAL | Caching configuration |

### 13.2 Disclosure Object

Controls progressive information disclosure:

```yaml
disclosure:
  default: summary
  
  levels:
    summary:
      visible_metrics:
        - "sales.total_revenue"
      show_comparison: true
      show_sparkline: false
      
    detail:
      visible_metrics:
        - "sales.total_revenue"
        - "sales.total_orders"
        - "sales.average_order_value"
      show_comparison: true
      show_sparkline: true
      
    full:
      visible_metrics: all
      show_comparison: true
      show_sparkline: true
      show_data_table: true
      
  transitions:
    - from: summary
      to: detail
      trigger: click
    - from: detail
      to: full
      trigger: click
    - from: any
      to: summary
      trigger: escape
```

### 13.3 Conditional Display

```yaml
conditional:
  display_when:
    type: all               # all | any | none
    conditions:
      - type: filter_active
        filter_id: region_filter
        
      - type: data_exists
        min_rows: 1
        
      - type: metric_threshold
        metric: "sales.total_revenue"
        operator: gt
        value: 0
        
      - type: persona
        values:
          - executive
          - manager
          
      - type: device
        values:
          - desktop
          - tablet
          
  fallback:
    type: message           # message | hide | placeholder
    message: "Select a region to view this chart"
```

---

## 14. Visualisation Types


### 14.1 Type Categories

| Category | Types | Conformance |
|----------|-------|-------------|
| **Core** | kpi, trend, bar, table, pie, text, progress | REQUIRED |
| **Extended** | scatter, heatmap, funnel, gauge, map, treemap, sankey, histogram, waterfall, bullet, sparkline | RECOMMENDED |
| **Extended (Goal)** | okr, scorecard, roadmap | RECOMMENDED |
| **Special** | auto, composite, custom | REQUIRED (auto, composite), OPTIONAL (custom) |

### 14.2 KPI Type

Single metric display with optional comparison and sparkline.

```yaml
type: kpi

options:
  # Value formatting
  format:
    style: currency           # number | currency | percent | duration | custom
    currency: USD             # ISO 4217 code
    precision: 0              # Decimal places
    notation: compact         # standard | compact | scientific | engineering
    sign_display: auto        # auto | always | never | except_zero
    
  # Comparison
  comparison:
    enabled: true
    type: previous_period     # previous_period | previous_year | target | custom
    show_absolute: true
    show_percent: true
    invert_colors: false      # True for cost-type metrics
    format:
      style: percent
      precision: 1
      sign_display: always
    
  # Sparkline
  sparkline:
    enabled: true
    type: area                # line | area | bar
    height: 40
    periods: 12
    show_min_max: false
    show_current: true
    
  # Target
  target:
    value: 1500000
    source:
      ref: "sales.revenue_target"    # Or static value above
    label: "Q4 Target"
    show_progress: true
    progress_style: bar       # bar | ring | text
    
  # Status thresholds
  thresholds:
    mode: absolute            # absolute | percent_of_target
    values:
      - max: 0.8
        status: negative
        label: "Critical"
      - max: 1.0
        status: warning
        label: "Below Target"
      - max: 1.2
        status: neutral
        label: "On Track"
      - min: 1.2
        status: positive
        label: "Exceeding"
        
  # Layout
  layout:
    value_size: large         # small | medium | large | xlarge
    label_position: top       # top | bottom | none
    comparison_position: right # right | bottom | inline
```

**Complete KPI Example**:

```yaml
panels:
  - id: revenue_kpi
    type: kpi
    title: "Total Revenue"
    description: "Sum of all completed orders in the selected period"
    
    position:
      row: 0
      column: 0
      width: 3
      height: 2
    
    data:
      source: sales
      metrics:
        - ref: "sales.total_revenue"
      time_range:
        inherit: dashboard
      comparison: true
    
    options:
      format:
        style: currency
        currency: USD
        notation: compact
      comparison:
        enabled: true
        type: previous_period
        show_absolute: true
        show_percent: true
      sparkline:
        enabled: true
        type: area
        periods: 12
      thresholds:
        mode: absolute
        values:
          - max: 1000000
            status: negative
          - max: 3000000
            status: neutral
          - min: 3000000
            status: positive
    
    interactions:
      - trigger: click
        action: drill_through
        target: "revenue-detail-dashboard"
        context:
          preserve_filters: true
          
    accessibility:
      alt_text: "Revenue is $4.2 million, up 12% from last period"
```

### 14.3 Trend Type

Time-series visualisation for temporal patterns.

```yaml
type: trend

options:
  # Chart style
  style: area                 # line | area | bar | stacked_area | stacked_bar | stream
  
  # Series configuration
  series:
    interpolation: monotone   # linear | monotone | step | step_before | step_after | basis | cardinal
    stroke_width: 2
    point:
      show: false             # true | false | hover
      radius: 4
      hover_radius: 6
    area:
      opacity: 0.3
      gradient:
        enabled: true
        direction: vertical   # vertical | horizontal
        from_opacity: 0.4
        to_opacity: 0.05
  
  # Axes
  x_axis:
    show: true
    type: time
    format: auto              # auto | or strftime pattern
    label: null               # null to hide axis label
    grid:
      show: false
      style: dashed           # solid | dashed | dotted
    ticks:
      count: auto             # auto | specific number
      rotate: 0               # Degrees
      
  y_axis:
    show: true
    type: linear              # linear | log | sqrt | symlog
    format:
      style: currency
      currency: USD
      notation: compact
    label: null
    min: 0                    # null for auto
    max: null
    grid:
      show: true
      style: dashed
    
  # Secondary Y-axis (for dual-axis charts)
  y_axis_secondary:
    enabled: false
    metrics:
      - "sales.conversion_rate"
    format:
      style: percent
    
  # Reference lines
  reference_lines:
    - type: average
      style: dashed
      color: "theme:semantic.neutral"
      label: "Average"
      label_position: end     # start | end | none
      
    - type: target
      value: 1500000
      style: solid
      color: "theme:semantic.info"
      label: "Target"
      
    - type: trend             # Linear regression line
      style: dotted
      color: "theme:secondary"
      show_equation: false
      show_r_squared: false
  
  # Annotations
  annotations:
    - date: "2025-11-25"
      label: "Black Friday"
      style: flag             # flag | line | region
      color: "theme:semantic.info"
      
    - start_date: "2025-12-20"
      end_date: "2025-12-26"
      label: "Holiday Period"
      style: region
      color: "rgba(255, 193, 7, 0.2)"
  
  # Comparison overlay
  comparison:
    enabled: true
    style: line               # line | area | background
    opacity: 0.5
    label: "Previous Period"
    
  # Legend
  legend:
    show: true
    position: bottom          # top | bottom | left | right | none
    interactive: true         # Click to toggle series
    
  # Tooltip
  tooltip:
    enabled: true
    trigger: hover            # hover | click
    shared: true              # Show all series values
    format:
      date: "MMMM D, YYYY"
      value: "0,0.00"
      
  # Zoom and pan
  zoom:
    enabled: false
    type: x                   # x | y | xy
  pan:
    enabled: false
```

### 14.4 Bar Type

Categorical comparison visualisation.

```yaml
type: bar

options:
  # Orientation
  orientation: vertical       # vertical | horizontal
  
  # Grouping
  mode: grouped               # grouped | stacked | stacked_percent
  
  # Bar styling
  bar:
    width: 0.7                # 0-1, proportion of available space
    corner_radius: 4          # Pixels, 0 for square
    gap: 0.1                  # Gap between grouped bars
    
  # Sorting
  sort:
    by: value                 # value | label | natural | custom
    direction: desc           # asc | desc
    limit: null               # Top/bottom N
    
  # Labels
  labels:
    show: false               # Show value labels on bars
    position: outside         # inside | outside | center
    format:
      style: number
      notation: compact
    min_bar_size: 30          # Minimum bar size to show label
    
  # Axes
  x_axis:
    show: true
    label: null
    grid:
      show: false
    ticks:
      rotate: 0
      max_length: 20          # Truncate labels
      
  y_axis:
    show: true
    format:
      style: currency
      currency: USD
      notation: compact
    min: 0
    grid:
      show: true
      
  # Reference lines
  reference_lines:
    - type: average
      label: "Average"
      
  # Legend (for grouped/stacked)
  legend:
    show: true
    position: bottom
    
  # Comparison (only for single series)
  comparison:
    enabled: true
    show_delta: true
    delta_position: end       # end | overlay
```

### 14.5 Table Type

Tabular data display with sorting, pagination, and formatting.

```yaml
type: table

options:
  # Columns
  columns:
    - field: "geography.region"
      header: "Region"
      width: 150              # Pixels, or "auto"
      align: left             # left | center | right
      sortable: true
      filterable: true
      frozen: true            # Freeze when scrolling horizontally
      
    - field: "sales.total_revenue"
      header: "Revenue"
      width: 120
      align: right
      sortable: true
      format:
        style: currency
        currency: USD
        notation: compact
      conditional_formatting:
        - condition:
            operator: gte
            value: 1000000
          style:
            background: "rgba(76, 175, 80, 0.2)"
            font_weight: bold
            
    - field: "sales.growth_rate"
      header: "Growth"
      width: 100
      align: right
      format:
        style: percent
        precision: 1
        sign_display: always
      cell_type: delta        # text | delta | bar | sparkline | link
      
    - field: "sales.trend"
      header: "Trend"
      width: 80
      cell_type: sparkline
      sparkline:
        type: line
        height: 24
        
  # Sorting
  default_sort:
    - field: "sales.total_revenue"
      direction: desc
      
  # Pagination
  pagination:
    enabled: true
    page_size: 25
    page_size_options:
      - 10
      - 25
      - 50
      - 100
    position: bottom
    
  # Row features
  row:
    height: 48
    striped: true
    hover_highlight: true
    selection:
      enabled: false
      mode: single            # single | multiple
      
  # Header
  header:
    sticky: true
    height: 48
    
  # Footer
  footer:
    show: false
    aggregations:
      - field: "sales.total_revenue"
        function: sum
        label: "Total"
        
  # Export
  export:
    enabled: true
    formats:
      - csv
      - xlsx
      
  # Search
  search:
    enabled: true
    placeholder: "Search..."
    fields: all               # all | [specific fields]
    
  # Column visibility
  column_visibility:
    enabled: true
    default_hidden: []
```

### 14.6 Pie Type

Part-to-whole relationships.

```yaml
type: pie

options:
  # Variant
  variant: pie                # pie | donut | semi
  
  # Donut configuration
  donut:
    inner_radius: 0.6         # 0-1, proportion of outer radius
    center_label:
      show: true
      value: "total"          # total | percent | custom
      custom_text: null
      format:
        style: currency
        currency: USD
        
  # Segments
  segments:
    min_angle: 5              # Minimum angle in degrees
    pad_angle: 2              # Gap between segments
    corner_radius: 4
    explode: null             # Segment ID to explode, or "hover"
    
  # Sorting
  sort:
    by: value                 # value | label | none
    direction: desc
    
  # Labels
  labels:
    show: true
    type: percent             # value | percent | label | both
    position: outside         # inside | outside
    connector:
      show: true
      style: curved           # straight | curved
    min_percent: 5            # Hide labels below this percent
    
  # Legend
  legend:
    show: true
    position: right
    
  # Limit
  max_segments: 8
  other_label: "Other"
  other_color: "theme:neutral.400"
```

### 14.7 Scatter Type

Correlation between two metrics.

```yaml
type: scatter

options:
  # Axes
  x_metric:
    ref: "sales.deal_size"
    format:
      style: currency
      currency: USD
      
  y_metric:
    ref: "sales.win_rate"
    format:
      style: percent
      
  # Optional: size encoding
  size_metric:
    ref: "sales.deal_count"
    range:
      min: 4
      max: 40
      
  # Optional: color encoding
  color_dimension:
    ref: "geography.region"
    
  # Points
  point:
    shape: circle             # circle | square | triangle | diamond
    opacity: 0.7
    stroke_width: 1
    
  # Axes configuration
  x_axis:
    show: true
    label: "Average Deal Size"
    min: 0
    max: null
    grid:
      show: true
      
  y_axis:
    show: true
    label: "Win Rate"
    min: 0
    max: 1
    format:
      style: percent
    grid:
      show: true
      
  # Reference lines
  quadrants:
    enabled: true
    x_threshold: 50000
    y_threshold: 0.3
    labels:
      top_right: "Stars"
      top_left: "Question Marks"
      bottom_right: "Cash Cows"
      bottom_left: "Dogs"
      
  # Trend line
  trend_line:
    enabled: true
    type: linear              # linear | polynomial | loess
    show_equation: true
    show_r_squared: true
    confidence_interval: 0.95
    
  # Labels
  labels:
    show: false
    field: "account.name"
    collision_detection: true
    
  # Tooltip
  tooltip:
    fields:
      - "account.name"
      - "sales.deal_size"
      - "sales.win_rate"
```

### 14.8 Heatmap Type

Matrix with color intensity.

```yaml
type: heatmap

options:
  # Axes
  x_dimension:
    ref: "time.day_of_week"
    order:
      - "Monday"
      - "Tuesday"
      - "Wednesday"
      - "Thursday"
      - "Friday"
      - "Saturday"
      - "Sunday"
      
  y_dimension:
    ref: "time.hour_of_day"
    format: "HH:00"
    
  # Color
  color:
    metric:
      ref: "events.count"
    scale: sequential         # sequential | diverging
    palette: blues            # Named palette or custom
    reverse: false
    domain:
      - 0
      - 100
    missing: "theme:neutral.100"
    
  # Cells
  cell:
    gap: 2
    corner_radius: 2
    border:
      show: false
      color: "theme:background"
      width: 1
      
  # Labels
  labels:
    show: true
    min_cell_size: 30
    format:
      style: number
      notation: compact
      
  # Legend
  legend:
    show: true
    position: right
    type: gradient            # gradient | discrete
    
  # Axes
  x_axis:
    show: true
    position: top
    
  y_axis:
    show: true
    position: left
```

### 14.9 Funnel Type

Sequential conversion stages.

```yaml
type: funnel

options:
  # Orientation
  orientation: vertical       # vertical | horizontal
  
  # Shape
  shape: funnel               # funnel | pyramid | bars
  
  # Stages
  stages:
    dimension:
      ref: "funnel.stage"
    order:
      - "Visitors"
      - "Sign-ups"
      - "Activated"
      - "Subscribed"
      - "Retained"
      
  # Metrics
  value_metric:
    ref: "funnel.count"
    
  # Conversion display
  conversion:
    show: true
    type: step                # step | cumulative
    position: between         # between | below | right
    format:
      style: percent
      precision: 1
      
  # Labels
  labels:
    show: true
    position: inside          # inside | outside
    show_value: true
    show_percent: true
    
  # Styling
  gap: 4
  min_width: 0.3              # Minimum stage width as proportion
  
  # Legend
  legend:
    show: false
```

### 14.10 Gauge Type

Progress toward target.

```yaml
type: gauge

options:
  # Variant
  variant: radial             # radial | linear | bullet
  
  # Radial configuration
  radial:
    start_angle: -120
    end_angle: 120
    inner_radius: 0.7
    
  # Value
  value:
    format:
      style: percent
      precision: 0
    show: true
    position: center
    
  # Target
  target:
    value: 1.0                # Or metric ref
    show_marker: true
    
  # Range
  min: 0
  max: 1.5
  
  # Thresholds
  thresholds:
    - max: 0.5
      color: "theme:semantic.negative"
      label: "Critical"
    - max: 0.8
      color: "theme:semantic.warning"
      label: "Warning"
    - max: 1.0
      color: "theme:semantic.neutral"
      label: "On Track"
    - max: 1.5
      color: "theme:semantic.positive"
      label: "Exceeding"
      
  # Labels
  scale_labels:
    show: true
    format:
      style: percent
    count: 5
    
  # Title (for bullet variant)
  title_position: left
  subtitle: "vs Target"
```

### 14.11 Map Type

Geographic visualisation.

```yaml
type: map

options:
  # Map type
  variant: choropleth         # choropleth | bubble | point | flow
  
  # Geography
  geography:
    type: topojson
    url: "https://uds.dev/geo/world-110m.json"
    feature: countries
    join_field: "properties.iso_a3"
    
  # Data binding
  location_dimension:
    ref: "geography.country_code"
    
  # Choropleth configuration
  choropleth:
    metric:
      ref: "sales.total_revenue"
    color:
      scale: sequential
      palette: blues
    legend:
      show: true
      position: bottom_left
      
  # Bubble configuration (if variant: bubble)
  bubble:
    size_metric:
      ref: "sales.total_revenue"
    size_range:
      min: 5
      max: 50
    color_metric:
      ref: "sales.growth_rate"
    color_scale: diverging
    
  # Interaction
  zoom:
    enabled: true
    min: 1
    max: 8
    initial: 1
  pan:
    enabled: true
    
  # Projection
  projection: mercator        # mercator | equalEarth | naturalEarth | albers
  
  # Labels
  labels:
    show: false
    field: "properties.name"
    
  # Tooltip
  tooltip:
    enabled: true
    fields:
      - "geography.country"
      - "sales.total_revenue"
```

### 14.12 Text Type

Rich text content for annotations and explanations.

```yaml
type: text

options:
  # Content
  content:
    type: markdown            # markdown | html | plain
    value: |
      ## Key Insights
      
      Revenue grew **12% QoQ**, driven primarily by:
      
      1. EMEA expansion (+23%)
      2. New product line launch
      3. Improved conversion rates
      
      > Note: Excludes one-time items
      
  # Dynamic content
  dynamic:
    enabled: true
    metrics:
      - ref: "sales.total_revenue"
        alias: "revenue"
        format:
          style: currency
          currency: USD
      - ref: "sales.growth_rate"
        alias: "growth"
        format:
          style: percent
    template: |
      Revenue is {{revenue}}, {{growth}} vs last period.
      
  # Styling
  padding: 16
  background: transparent
  border: none
```

### 14.13 Auto Type

AI-selected visualisation based on data characteristics.

```yaml
type: auto

# AI generation hints
ai_hints:
  emphasis: comparison        # trend | comparison | distribution | composition | correlation | geographic
  highlight: outliers         # outliers | top_n | threshold | anomalies
  complexity: simple          # simple | moderate | complex
  guidance: |
    Show how each region performs against target.
    Highlight regions more than 10% below target.
    
# Constraints on auto-selection
constraints:
  allowed_types:
    - bar
    - table
    - trend
  prohibited_types:
    - pie                     # Avoid pie charts
  max_series: 5
  prefer_horizontal: true     # For bar charts
```

### 14.14 Composite Type

Multiple visualisations combined.

```yaml
type: composite

options:
  arrangement: overlay        # overlay | small_multiples | facet
  
  # For overlay
  layers:
    - type: bar
      data:
        metrics:
          - ref: "sales.total_revenue"
      options:
        opacity: 0.8
        
    - type: trend
      data:
        metrics:
          - ref: "sales.growth_rate"
      options:
        y_axis_position: right
        
  # For small multiples
  facet:
    dimension:
      ref: "geography.region"
    columns: 3
    shared_axes: true
    
  # Synchronisation
  sync:
    zoom: true
    brush: true
    tooltip: true
```

---

### 14.15 Progress Type

Single metric progress toward a target with optional milestones. Simpler than gauge (which shows current state); progress emphasises journey toward goal.

#### 14.15.1 Progress Options

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `metric` | MetricRef | REQUIRED | Current value metric |
| `target` | TargetConfig | REQUIRED | Target configuration |
| `start` | StartConfig | OPTIONAL | Starting point (default: 0) |
| `milestones` | Milestone[] | OPTIONAL | Intermediate milestones |
| `display` | ProgressDisplay | OPTIONAL | Display configuration |
| `status` | StatusConfig | OPTIONAL | Status thresholds |
| `time_context` | ProgressTimeContext | OPTIONAL | Time bounds |

#### 14.15.2 TargetConfig Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `value` | number | CONDITIONAL | Static target value |
| `metric` | MetricRef | CONDITIONAL | Dynamic target from metric |
| `label` | string | OPTIONAL | Target label |

One of `value` or `metric` MUST be provided.

#### 14.15.3 StartConfig Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `value` | number | OPTIONAL | Starting value (default: 0) |
| `metric` | MetricRef | OPTIONAL | Dynamic start from metric |
| `label` | string | OPTIONAL | Start label |

#### 14.15.4 Milestone Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `value` | number | REQUIRED | Milestone value |
| `label` | string | REQUIRED | Milestone label |
| `icon` | string | OPTIONAL | Milestone icon |
| `date` | date | OPTIONAL | Expected date |

#### 14.15.5 ProgressDisplay Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `style` | string | OPTIONAL | `bar`, `ring`, `linear`, `steps` (default: `bar`) |
| `show_percentage` | boolean | OPTIONAL | Show percentage complete (default: true) |
| `show_absolute` | boolean | OPTIONAL | Show absolute values (default: false) |
| `show_remaining` | boolean | OPTIONAL | Show remaining to target (default: false) |
| `show_milestones` | boolean | OPTIONAL | Display milestones (default: true) |
| `orientation` | string | OPTIONAL | `horizontal`, `vertical` (default: `horizontal`) |
| `size` | string | OPTIONAL | `small`, `medium`, `large` (default: `medium`) |
| `animate` | boolean | OPTIONAL | Animate progress changes (default: true) |

#### 14.15.6 StatusConfig Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `mode` | string | OPTIONAL | `progress_ratio`, `time_ratio`, `custom` (default: `progress_ratio`) |
| `thresholds` | StatusThreshold[] | OPTIONAL | Status thresholds |

**Status Modes**:

- `progress_ratio`: Status based on (current - start) / (target - start)
- `time_ratio`: Status based on progress vs elapsed time in period
- `custom`: Status based on custom thresholds

#### 14.15.7 StatusThreshold Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `min` | number | CONDITIONAL | Minimum value for this status |
| `max` | number | CONDITIONAL | Maximum value for this status |
| `status` | string | REQUIRED | `on_track`, `at_risk`, `behind`, `complete`, `exceeded` |
| `color` | string | OPTIONAL | Override color |
| `label` | string | OPTIONAL | Status label |

#### 14.15.8 ProgressTimeContext Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `start_date` | date | OPTIONAL | Period start |
| `end_date` | date | OPTIONAL | Period end |
| `show_timeline` | boolean | OPTIONAL | Show time progress alongside value progress |

#### 14.15.9 Complete Progress Example

```yaml
panels:
  - id: q1_revenue_progress
    type: progress
    title: "Q1 Revenue Target"
    description: "Progress toward quarterly revenue goal"
    
    position:
      row: 0
      column: 0
      width: 4
      height: 2
      
    data:
      source: sales
      metrics:
        - ref: "sales.total_revenue"
          
    options:
      metric:
        ref: "sales.total_revenue"
        
      target:
        value: 5000000
        label: "Q1 Target"
        
      start:
        value: 0
        
      milestones:
        - value: 1250000
          label: "Month 1"
          date: "2026-01-31"
        - value: 2500000
          label: "Month 2"
          date: "2026-02-28"
        - value: 3750000
          label: "Month 3"
          date: "2026-03-31"
          
      display:
        style: bar
        show_percentage: true
        show_absolute: true
        show_milestones: true
        orientation: horizontal
        size: large
        
      status:
        mode: time_ratio
        thresholds:
          - min: 0.9
            status: on_track
            color: "theme:semantic.positive"
          - min: 0.7
            max: 0.9
            status: at_risk
            color: "theme:semantic.warning"
          - max: 0.7
            status: behind
            color: "theme:semantic.negative"
          - min: 1.0
            status: complete
            color: "theme:semantic.positive"
            
      time_context:
        start_date: "2026-01-01"
        end_date: "2026-03-31"
        show_timeline: true
        
    accessibility:
      alt_text: |
        Q1 revenue progress: $3.2M of $5M target (64% complete).
        Status: On track. 67% of quarter elapsed.
        Milestone 1 ($1.25M) achieved. Milestone 2 ($2.5M) achieved.
```


### 14.16 OKR Type

Hierarchical Objectives and Key Results visualisation. Displays objectives with nested key results, progress tracking, confidence scoring, and status indicators.

#### 14.16.1 OKR Data Requirements

The OKR type uses the hybrid data binding pattern. It requires specific data roles to be filled:

| Role | Type | Required | Description |
|------|------|----------|-------------|
| `objective_id` | identifier | REQUIRED | Unique objective identifier |
| `objective_title` | string | REQUIRED | Objective display text |
| `key_result_id` | identifier | REQUIRED | Unique key result identifier |
| `key_result_title` | string | REQUIRED | Key result display text |
| `key_result_objective_id` | identifier | REQUIRED | Parent objective reference |
| `progress` | number (0-1) | REQUIRED | Progress toward completion |
| `target_value` | number | OPTIONAL | Target numeric value |
| `current_value` | number | OPTIONAL | Current numeric value |
| `start_value` | number | OPTIONAL | Starting value (default: 0) |
| `confidence` | number (0-1) | OPTIONAL | Confidence score |
| `owner` | string | OPTIONAL | Owner name or identifier |
| `period` | string | OPTIONAL | Time period (e.g., "2026-Q1") |
| `status` | string | OPTIONAL | Manual status override |
| `weight` | number | OPTIONAL | Weight for scoring |

#### 14.16.2 OKR Options Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `bindings` | OKRBindings | REQUIRED | Maps semantic refs to data roles |
| `structure` | OKRStructure | OPTIONAL | Hierarchy configuration |
| `display` | OKRDisplay | OPTIONAL | Display options |
| `scoring` | OKRScoring | OPTIONAL | Score calculation |
| `status_thresholds` | StatusThreshold[] | OPTIONAL | Status determination |
| `period` | OKRPeriod | OPTIONAL | Period selector |
| `grouping` | OKRGrouping | OPTIONAL | Group objectives by attribute |

#### 14.16.3 OKRBindings Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `objective_id` | string | REQUIRED | Metric/dimension ref for objective ID |
| `objective_title` | string | REQUIRED | Metric/dimension ref for objective title |
| `key_result_id` | string | REQUIRED | Metric/dimension ref for KR ID |
| `key_result_title` | string | REQUIRED | Metric/dimension ref for KR title |
| `key_result_objective_id` | string | REQUIRED | Metric/dimension ref for parent link |
| `progress` | string | REQUIRED | Metric ref for progress (0-1) |
| `target_value` | string | OPTIONAL | Metric ref for target |
| `current_value` | string | OPTIONAL | Metric ref for current value |
| `start_value` | string | OPTIONAL | Metric ref for start value |
| `confidence` | string | OPTIONAL | Metric ref for confidence |
| `owner` | string | OPTIONAL | Dimension ref for owner |
| `period` | string | OPTIONAL | Dimension ref for period |
| `status` | string | OPTIONAL | Dimension ref for manual status |
| `weight` | string | OPTIONAL | Metric ref for weight |

#### 14.16.4 OKRStructure Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `max_levels` | integer | OPTIONAL | Max nesting depth (default: 2) |
| `allow_nested_objectives` | boolean | OPTIONAL | Objectives can contain objectives (default: false) |
| `key_results_required` | boolean | OPTIONAL | Objectives must have KRs (default: false) |

#### 14.16.5 OKRDisplay Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `layout` | string | OPTIONAL | `nested`, `flat`, `tree`, `cards` (default: `nested`) |
| `show_objective_progress` | boolean | OPTIONAL | Aggregate KR progress (default: true) |
| `show_key_result_progress` | boolean | OPTIONAL | Show individual KR progress (default: true) |
| `show_confidence` | boolean | OPTIONAL | Display confidence scores (default: true) |
| `show_owner` | boolean | OPTIONAL | Display owners (default: true) |
| `show_period` | boolean | OPTIONAL | Display period (default: true) |
| `show_values` | boolean | OPTIONAL | Show current/target values (default: false) |
| `progress_style` | string | OPTIONAL | `bar`, `ring`, `percent` (default: `bar`) |
| `expandable` | boolean | OPTIONAL | Objectives can expand/collapse (default: true) |
| `default_expanded` | integer | OPTIONAL | Levels expanded by default (default: 1) |
| `empty_state` | string | OPTIONAL | Message when no OKRs |

#### 14.16.6 OKRScoring Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `method` | string | OPTIONAL | `average`, `weighted`, `min`, `custom` (default: `average`) |
| `scale` | string | OPTIONAL | `0-1`, `0-100`, `0-10` (default: `0-1`) |
| `include_confidence` | boolean | OPTIONAL | Factor confidence into score (default: false) |

**Scoring Methods**:

- `average`: Simple average of KR progress
- `weighted`: Weighted average using `weight` binding
- `min`: Lowest KR progress (conservative)
- `custom`: Use pre-calculated objective progress from semantic layer

#### 14.16.7 OKRPeriod Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `current` | string | OPTIONAL | Current period value |
| `show_selector` | boolean | OPTIONAL | Show period dropdown (default: true) |
| `available` | string[] | OPTIONAL | Available periods |
| `format` | string | OPTIONAL | Period display format |

#### 14.16.8 OKRGrouping Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `enabled` | boolean | OPTIONAL | Enable grouping (default: false) |
| `dimension` | string | OPTIONAL | Dimension to group by |
| `show_group_progress` | boolean | OPTIONAL | Show aggregate per group |

#### 14.16.9 Complete OKR Example

```yaml
panels:
  - id: company_okrs
    type: okr
    title: "Q1 2026 Company OKRs"
    description: "Strategic objectives and key results for Q1"
    
    position:
      row: 0
      column: 0
      width: 12
      height: 6
      
    data:
      source: goals
      metrics:
        - ref: "goals.progress"
        - ref: "goals.target_value"
        - ref: "goals.current_value"
        - ref: "goals.confidence_score"
        - ref: "goals.weight"
      dimensions:
        - ref: "goals.objective_id"
        - ref: "goals.objective_title"
        - ref: "goals.kr_id"
        - ref: "goals.kr_title"
        - ref: "goals.kr_objective_id"
        - ref: "goals.owner_name"
        - ref: "goals.quarter"
      filters:
        - dimension: "goals.quarter"
          operator: eq
          value: "2026-Q1"
        - dimension: "goals.level"
          operator: eq
          value: "company"
          
    options:
      bindings:
        # Required bindings
        objective_id: "goals.objective_id"
        objective_title: "goals.objective_title"
        key_result_id: "goals.kr_id"
        key_result_title: "goals.kr_title"
        key_result_objective_id: "goals.kr_objective_id"
        progress: "goals.progress"
        # Optional bindings
        target_value: "goals.target_value"
        current_value: "goals.current_value"
        confidence: "goals.confidence_score"
        owner: "goals.owner_name"
        period: "goals.quarter"
        weight: "goals.weight"
        
      display:
        layout: nested
        show_objective_progress: true
        show_key_result_progress: true
        show_confidence: true
        show_owner: true
        show_values: true
        progress_style: bar
        expandable: true
        default_expanded: 1
        
      scoring:
        method: weighted
        scale: "0-1"
        include_confidence: false
        
      status_thresholds:
        - min: 0.7
          status: on_track
          color: "theme:semantic.positive"
          label: "On Track"
        - min: 0.4
          max: 0.7
          status: at_risk
          color: "theme:semantic.warning"
          label: "At Risk"
        - max: 0.4
          status: behind
          color: "theme:semantic.negative"
          label: "Behind"
        - min: 1.0
          status: complete
          color: "theme:semantic.positive"
          label: "Complete"
          
      period:
        current: "2026-Q1"
        show_selector: true
        available:
          - "2025-Q4"
          - "2026-Q1"
          - "2026-Q2"
        format: "YYYY-[Q]Q"
        
    interactions:
      - trigger: click
        action: drill_down
        context:
          pass_dimensions:
            - "goals.objective_id"
            
      - trigger: hover
        action: tooltip
        
    accessibility:
      alt_text: |
        Company OKRs for Q1 2026 showing 3 objectives.
        Overall progress: 67%. Status: On Track.
        Objective 1: Increase Revenue - 75% complete, 3 key results.
        Objective 2: Improve Customer Satisfaction - 62% complete, 4 key results.
        Objective 3: Launch New Product - 58% complete, 3 key results.
```


### 14.17 Scorecard Type

Balanced Scorecard or categorised metrics visualisation. Displays metrics organised into perspectives (categories) with targets, weights, and aggregate scoring.

#### 14.17.1 Scorecard Data Requirements

| Role | Type | Required | Description |
|------|------|----------|-------------|
| `perspective_id` | identifier | REQUIRED | Category/perspective identifier |
| `perspective_name` | string | REQUIRED | Category display name |
| `metric_id` | identifier | REQUIRED | Metric identifier |
| `metric_name` | string | REQUIRED | Metric display name |
| `metric_perspective_id` | identifier | REQUIRED | Parent perspective reference |
| `current_value` | number | REQUIRED | Current metric value |
| `target_value` | number | REQUIRED | Target value |
| `weight` | number | OPTIONAL | Metric weight in perspective |
| `lower_is_better` | boolean | OPTIONAL | Invert comparison (for costs, times) |
| `unit` | string | OPTIONAL | Value unit |
| `trend` | number | OPTIONAL | Trend direction/value |

#### 14.17.2 Scorecard Options Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `bindings` | ScorecardBindings | REQUIRED | Maps semantic refs to data roles |
| `perspectives` | PerspectiveConfig[] | OPTIONAL | Static perspective definitions |
| `display` | ScorecardDisplay | OPTIONAL | Display options |
| `scoring` | ScorecardScoring | OPTIONAL | Score calculation |
| `status_thresholds` | StatusThreshold[] | OPTIONAL | Status determination |

#### 14.17.3 ScorecardBindings Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `perspective_id` | string | REQUIRED | Dimension ref for perspective ID |
| `perspective_name` | string | REQUIRED | Dimension ref for perspective name |
| `metric_id` | string | REQUIRED | Dimension ref for metric ID |
| `metric_name` | string | REQUIRED | Dimension ref for metric name |
| `metric_perspective_id` | string | REQUIRED | Dimension ref for parent link |
| `current_value` | string | REQUIRED | Metric ref for current value |
| `target_value` | string | REQUIRED | Metric ref for target |
| `weight` | string | OPTIONAL | Metric ref for weight |
| `lower_is_better` | string | OPTIONAL | Dimension ref for inversion flag |
| `unit` | string | OPTIONAL | Dimension ref for unit |
| `trend` | string | OPTIONAL | Metric ref for trend |

#### 14.17.4 PerspectiveConfig Object (Alternative to Bindings)

For static scorecard definitions where perspectives are known at design time:

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | string | REQUIRED | Perspective identifier |
| `name` | string | REQUIRED | Display name |
| `icon` | string | OPTIONAL | Icon identifier |
| `color` | string | OPTIONAL | Perspective color |
| `weight` | number | OPTIONAL | Perspective weight in overall score |
| `metrics` | PerspectiveMetric[] | REQUIRED | Metrics in this perspective |

#### 14.17.5 PerspectiveMetric Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `ref` | string | REQUIRED | Semantic metric reference |
| `name` | string | OPTIONAL | Display name override |
| `target` | number | REQUIRED | Target value |
| `weight` | number | OPTIONAL | Weight within perspective |
| `lower_is_better` | boolean | OPTIONAL | Invert comparison |
| `format` | Format | OPTIONAL | Value format |

#### 14.17.6 ScorecardDisplay Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `layout` | string | OPTIONAL | `quadrant`, `list`, `cards`, `table` (default: `quadrant`) |
| `show_overall_score` | boolean | OPTIONAL | Show aggregate score (default: true) |
| `show_perspective_scores` | boolean | OPTIONAL | Show per-perspective scores (default: true) |
| `show_metric_details` | boolean | OPTIONAL | Show individual metrics (default: true) |
| `show_targets` | boolean | OPTIONAL | Show target values (default: true) |
| `show_variance` | boolean | OPTIONAL | Show variance from target (default: true) |
| `show_trend` | boolean | OPTIONAL | Show trend indicators (default: true) |
| `compact` | boolean | OPTIONAL | Compact display mode (default: false) |

#### 14.17.7 ScorecardScoring Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `method` | string | OPTIONAL | `weighted_average`, `average`, `min` (default: `weighted_average`) |
| `scale` | string | OPTIONAL | `0-100`, `0-10`, `0-5`, `0-1` (default: `0-100`) |
| `normalize` | boolean | OPTIONAL | Normalize metrics to common scale (default: true) |
| `perspective_aggregation` | string | OPTIONAL | `weighted`, `average` (default: `weighted`) |

#### 14.17.8 Complete Scorecard Example

```yaml
panels:
  - id: balanced_scorecard
    type: scorecard
    title: "Strategic Scorecard Q1 2026"
    description: "Balanced scorecard across four strategic perspectives"
    
    position:
      row: 0
      column: 0
      width: 12
      height: 5
      
    data:
      source: scorecard_data
      metrics:
        - ref: "scorecard.current_value"
        - ref: "scorecard.target_value"
        - ref: "scorecard.weight"
        - ref: "scorecard.trend"
      dimensions:
        - ref: "scorecard.perspective_id"
        - ref: "scorecard.perspective_name"
        - ref: "scorecard.metric_id"
        - ref: "scorecard.metric_name"
        - ref: "scorecard.metric_perspective_id"
        - ref: "scorecard.unit"
        - ref: "scorecard.lower_is_better"
          
    options:
      # Using bindings approach (dynamic from semantic layer)
      bindings:
        perspective_id: "scorecard.perspective_id"
        perspective_name: "scorecard.perspective_name"
        metric_id: "scorecard.metric_id"
        metric_name: "scorecard.metric_name"
        metric_perspective_id: "scorecard.metric_perspective_id"
        current_value: "scorecard.current_value"
        target_value: "scorecard.target_value"
        weight: "scorecard.weight"
        lower_is_better: "scorecard.lower_is_better"
        unit: "scorecard.unit"
        trend: "scorecard.trend"
        
      display:
        layout: quadrant
        show_overall_score: true
        show_perspective_scores: true
        show_metric_details: true
        show_targets: true
        show_variance: true
        show_trend: true
        
      scoring:
        method: weighted_average
        scale: "0-100"
        normalize: true
        perspective_aggregation: weighted
        
      status_thresholds:
        - min: 90
          status: excellent
          color: "theme:semantic.positive"
          label: "Excellent"
        - min: 70
          max: 90
          status: good
          color: "theme:semantic.neutral"
          label: "Good"
        - min: 50
          max: 70
          status: needs_improvement
          color: "theme:semantic.warning"
          label: "Needs Improvement"
        - max: 50
          status: critical
          color: "theme:semantic.negative"
          label: "Critical"
          
    accessibility:
      alt_text: |
        Balanced Scorecard for Q1 2026. Overall score: 78/100 (Good).
        Financial: 85/100 - Revenue growth 12% (target 15%), Profit margin 22% (target 20%).
        Customer: 72/100 - NPS 45 (target 50), Retention 88% (target 90%).
        Internal Process: 80/100 - Cycle time 4.2 days (target 5).
        Learning & Growth: 75/100 - Training hours 38 (target 40).
```

**Alternative: Static Perspectives Configuration**

```yaml
panels:
  - id: balanced_scorecard_static
    type: scorecard
    title: "Strategic Scorecard"
    
    position:
      row: 0
      column: 0
      width: 12
      height: 5
      
    data:
      source: company_metrics
      metrics:
        - ref: "finance.revenue_growth"
        - ref: "finance.profit_margin"
        - ref: "customer.nps"
        - ref: "customer.retention_rate"
        - ref: "ops.cycle_time"
        - ref: "hr.training_hours"
          
    options:
      perspectives:
        - id: financial
          name: "Financial"
          icon: "currency"
          color: "theme:categorical.0"
          weight: 0.30
          metrics:
            - ref: "finance.revenue_growth"
              name: "Revenue Growth"
              target: 0.15
              weight: 0.6
              format:
                style: percent
            - ref: "finance.profit_margin"
              name: "Profit Margin"
              target: 0.20
              weight: 0.4
              format:
                style: percent
                
        - id: customer
          name: "Customer"
          icon: "people"
          color: "theme:categorical.1"
          weight: 0.25
          metrics:
            - ref: "customer.nps"
              name: "Net Promoter Score"
              target: 50
              weight: 0.5
            - ref: "customer.retention_rate"
              name: "Customer Retention"
              target: 0.90
              weight: 0.5
              format:
                style: percent
                
        - id: internal
          name: "Internal Process"
          icon: "settings"
          color: "theme:categorical.2"
          weight: 0.25
          metrics:
            - ref: "ops.cycle_time"
              name: "Cycle Time"
              target: 5
              weight: 1.0
              lower_is_better: true
              format:
                style: number
                suffix: " days"
                
        - id: learning
          name: "Learning & Growth"
          icon: "school"
          color: "theme:categorical.3"
          weight: 0.20
          metrics:
            - ref: "hr.training_hours"
              name: "Training Hours"
              target: 40
              weight: 1.0
              
      display:
        layout: quadrant
        show_overall_score: true
        
      scoring:
        method: weighted_average
        scale: "0-100"
```


### 14.18 Roadmap Type

Timeline visualisation showing phases, milestones, and progress over time. Used for strategic planning, project tracking, and initiative progress.

#### 14.18.1 Roadmap Data Requirements

| Role | Type | Required | Description |
|------|------|----------|-------------|
| `item_id` | identifier | REQUIRED | Item identifier |
| `item_title` | string | REQUIRED | Item display text |
| `item_type` | string | REQUIRED | `phase`, `milestone`, `task`, `initiative` |
| `start_date` | date | REQUIRED | Start date |
| `end_date` | date | CONDITIONAL | End date (required for phases/tasks) |
| `progress` | number (0-1) | OPTIONAL | Completion progress |
| `status` | string | OPTIONAL | Status indicator |
| `parent_id` | identifier | OPTIONAL | Parent item (for nesting) |
| `lane` | string | OPTIONAL | Swim lane assignment |
| `dependencies` | identifier[] | OPTIONAL | Dependent item IDs |
| `owner` | string | OPTIONAL | Owner/assignee |
| `color` | string | OPTIONAL | Item color |

#### 14.18.2 Roadmap Options Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `bindings` | RoadmapBindings | REQUIRED | Maps semantic refs to data roles |
| `timeline` | TimelineConfig | OPTIONAL | Timeline configuration |
| `display` | RoadmapDisplay | OPTIONAL | Display options |
| `lanes` | LaneConfig | OPTIONAL | Swim lane configuration |
| `dependencies` | DependencyConfig | OPTIONAL | Dependency display |
| `today_marker` | TodayMarker | OPTIONAL | Current date indicator |

#### 14.18.3 RoadmapBindings Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `item_id` | string | REQUIRED | Dimension ref for item ID |
| `item_title` | string | REQUIRED | Dimension ref for title |
| `item_type` | string | REQUIRED | Dimension ref for type |
| `start_date` | string | REQUIRED | Dimension ref for start date |
| `end_date` | string | OPTIONAL | Dimension ref for end date |
| `progress` | string | OPTIONAL | Metric ref for progress |
| `status` | string | OPTIONAL | Dimension ref for status |
| `parent_id` | string | OPTIONAL | Dimension ref for parent |
| `lane` | string | OPTIONAL | Dimension ref for lane |
| `dependencies` | string | OPTIONAL | Dimension ref for dependencies |
| `owner` | string | OPTIONAL | Dimension ref for owner |
| `color` | string | OPTIONAL | Dimension ref for color |

#### 14.18.4 TimelineConfig Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `start` | date | OPTIONAL | Timeline start (default: auto) |
| `end` | date | OPTIONAL | Timeline end (default: auto) |
| `granularity` | string | OPTIONAL | `day`, `week`, `month`, `quarter`, `year` (default: auto) |
| `show_weekends` | boolean | OPTIONAL | Show weekends (default: true) |
| `working_days` | integer[] | OPTIONAL | Working days (0=Sun, default: [1,2,3,4,5]) |
| `show_today` | boolean | OPTIONAL | Highlight today (default: true) |

#### 14.18.5 RoadmapDisplay Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `layout` | string | OPTIONAL | `gantt`, `timeline`, `swimlane`, `calendar` (default: `gantt`) |
| `show_progress` | boolean | OPTIONAL | Show progress bars (default: true) |
| `show_dependencies` | boolean | OPTIONAL | Show dependency lines (default: true) |
| `show_milestones` | boolean | OPTIONAL | Show milestone markers (default: true) |
| `show_labels` | boolean | OPTIONAL | Show item labels (default: true) |
| `label_position` | string | OPTIONAL | `inside`, `outside`, `tooltip` (default: `inside`) |
| `row_height` | integer | OPTIONAL | Row height in pixels |
| `expandable` | boolean | OPTIONAL | Phases can expand (default: true) |
| `zoom` | ZoomConfig | OPTIONAL | Zoom controls |

#### 14.18.6 LaneConfig Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `enabled` | boolean | OPTIONAL | Enable swim lanes (default: false) |
| `dimension` | string | OPTIONAL | Dimension for lane assignment |
| `order` | string[] | OPTIONAL | Lane display order |
| `colors` | object | OPTIONAL | Lane color mapping |
| `show_headers` | boolean | OPTIONAL | Show lane headers (default: true) |

#### 14.18.7 DependencyConfig Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `show` | boolean | OPTIONAL | Show dependency lines (default: true) |
| `style` | string | OPTIONAL | `arrow`, `line`, `bezier` (default: `arrow`) |
| `color` | string | OPTIONAL | Dependency line color |
| `highlight_critical` | boolean | OPTIONAL | Highlight critical path (default: false) |

#### 14.18.8 TodayMarker Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `show` | boolean | OPTIONAL | Show today marker (default: true) |
| `style` | string | OPTIONAL | `line`, `highlight`, `both` (default: `line`) |
| `color` | string | OPTIONAL | Marker color |
| `label` | string | OPTIONAL | Marker label |

#### 14.18.9 ZoomConfig Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `enabled` | boolean | OPTIONAL | Enable zoom (default: true) |
| `min_granularity` | string | OPTIONAL | Minimum zoom level |
| `max_granularity` | string | OPTIONAL | Maximum zoom level |
| `controls` | boolean | OPTIONAL | Show zoom controls (default: true) |

#### 14.18.10 Complete Roadmap Example

```yaml
panels:
  - id: product_roadmap
    type: roadmap
    title: "2026 Product Roadmap"
    description: "Strategic initiatives and milestones for 2026"
    
    position:
      row: 0
      column: 0
      width: 12
      height: 6
      
    data:
      source: roadmap_data
      metrics:
        - ref: "roadmap.progress"
      dimensions:
        - ref: "roadmap.item_id"
        - ref: "roadmap.item_title"
        - ref: "roadmap.item_type"
        - ref: "roadmap.start_date"
        - ref: "roadmap.end_date"
        - ref: "roadmap.status"
        - ref: "roadmap.parent_id"
        - ref: "roadmap.lane"
        - ref: "roadmap.dependencies"
        - ref: "roadmap.owner"
      filters:
        - dimension: "roadmap.year"
          operator: eq
          value: 2026
          
    options:
      bindings:
        item_id: "roadmap.item_id"
        item_title: "roadmap.item_title"
        item_type: "roadmap.item_type"
        start_date: "roadmap.start_date"
        end_date: "roadmap.end_date"
        progress: "roadmap.progress"
        status: "roadmap.status"
        parent_id: "roadmap.parent_id"
        lane: "roadmap.lane"
        dependencies: "roadmap.dependencies"
        owner: "roadmap.owner"
        
      timeline:
        start: "2026-01-01"
        end: "2026-12-31"
        granularity: month
        show_weekends: false
        show_today: true
        
      display:
        layout: gantt
        show_progress: true
        show_dependencies: true
        show_milestones: true
        show_labels: true
        label_position: inside
        expandable: true
        zoom:
          enabled: true
          min_granularity: week
          max_granularity: year
          controls: true
          
      lanes:
        enabled: true
        dimension: "roadmap.lane"
        order:
          - "Platform"
          - "Mobile"
          - "Integrations"
          - "Infrastructure"
        show_headers: true
        
      dependencies:
        show: true
        style: arrow
        highlight_critical: true
        
      today_marker:
        show: true
        style: both
        label: "Today"
        
      status_thresholds:
        - status: on_track
          color: "theme:semantic.positive"
        - status: at_risk
          color: "theme:semantic.warning"
        - status: delayed
          color: "theme:semantic.negative"
        - status: complete
          color: "theme:semantic.info"
          
    interactions:
      - trigger: click
        action: drill_down
        context:
          pass_dimensions:
            - "roadmap.item_id"
            
      - trigger: hover
        action: tooltip
        
    accessibility:
      alt_text: |
        2026 Product Roadmap showing 4 swim lanes and 12 initiatives.
        Platform: 3 initiatives, 45% complete overall.
        Mobile: 4 initiatives, 30% complete overall.
        Integrations: 3 initiatives, 60% complete overall.
        Infrastructure: 2 initiatives, 25% complete overall.
        Next milestone: Mobile App v2.0 launch on March 15.
```

---
## 15. Interactivity

### 15.1 Interaction Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `trigger` | string | REQUIRED | User action trigger |
| `action` | string | REQUIRED | Resulting action |
| `target` | string | CONDITIONAL | Action target |
| `context` | InteractionContext | OPTIONAL | Context to pass |
| `condition` | Condition | OPTIONAL | Conditional execution |

### 15.2 Triggers

| Trigger | Description |
|---------|-------------|
| `click` | Single click/tap |
| `double_click` | Double click/tap |
| `right_click` | Right click / long press |
| `hover` | Mouse hover (desktop only) |
| `focus` | Keyboard focus |
| `context_menu` | Context menu request |

### 15.3 Actions

| Action | Description | Requires Target |
|--------|-------------|-----------------|
| `drill_down` | Navigate to detail view | Yes (panel ID) |
| `drill_through` | Navigate to different dashboard | Yes (dashboard ID) |
| `filter` | Apply filter to dashboard | No |
| `highlight` | Highlight related data | No |
| `tooltip` | Show tooltip | No |
| `export` | Export data | No |
| `external_link` | Open external URL | Yes (URL template) |
| `copy` | Copy value to clipboard | No |
| `custom` | Custom action (extension) | Yes (handler ID) |

### 15.4 Interaction Context

```yaml
interactions:
  - trigger: click
    action: drill_through
    target: "revenue-by-product"
    context:
      # Pass clicked dimension value
      pass_dimensions:
        - "geography.region"
        - "time.month"
      
      # Pass current filters
      preserve_filters: true
      
      # Pass specific values
      parameters:
        source_dashboard: "${dashboard.id}"
        clicked_value: "${interaction.value}"
```

### 15.5 Cross-Filtering

Dashboard-level cross-filter configuration:

```yaml
cross_filter:
  enabled: true
  mode: highlight             # highlight | filter
  
  # Styling for highlight mode
  highlight:
    selected_opacity: 1.0
    unselected_opacity: 0.3
    transition_duration: 200
    
  # Scope
  exclude_panels:
    - summary_text
    - header_kpi
    
  # Relationships
  relationships:
    - source_panels:
        - region_bar
      target_panels:
        - revenue_trend
        - product_table
      dimension: "geography.region"
      
    - source_panels:
        - product_pie
      target_panels:
        - region_bar
        - revenue_trend
      dimension: "product.category"
```

### 15.6 Drill Paths

```yaml
drill_paths:
  - id: geographic
    name: "Geographic Hierarchy"
    levels:
      - dimension: "geography.region"
        panel_template:
          type: bar
          options:
            orientation: horizontal
            
      - dimension: "geography.country"
        panel_template:
          type: bar
          
      - dimension: "geography.city"
        panel_template:
          type: table

  - id: temporal
    name: "Time Hierarchy"
    levels:
      - dimension: "time.year"
      - dimension: "time.quarter"
      - dimension: "time.month"
      - dimension: "time.week"
      - dimension: "time.day"
```

---

## 16. Filters and Variables

### 16.1 Filter Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | Identifier | REQUIRED | Unique filter identifier |
| `dimension` | string | REQUIRED | Dimension to filter |
| `type` | string | REQUIRED | Filter UI type |
| `label` | string | OPTIONAL | Display label |
| `default` | any | OPTIONAL | Default value(s) |
| `required` | boolean | OPTIONAL | Must have selection |
| `multi` | boolean | OPTIONAL | Allow multiple selection |
| `options` | FilterOptions | OPTIONAL | Type-specific options |

### 16.2 Filter Types

| Type | Description | Multi Support |
|------|-------------|---------------|
| `select` | Dropdown select | Yes |
| `search` | Searchable select | Yes |
| `checkbox` | Checkbox list | Yes |
| `radio` | Radio button list | No |
| `toggle` | Boolean toggle | No |
| `range` | Numeric range slider | No |
| `date_range` | Date range picker | No |
| `tree` | Hierarchical tree select | Yes |
| `input` | Free text input | No |

```yaml
filters:
  - id: region_filter
    dimension: "geography.region"
    type: select
    label: "Region"
    multi: true
    default: ["all"]
    options:
      include_all: true
      all_label: "All Regions"
      sort: alpha
      
  - id: date_range
    dimension: "time.order_date"
    type: date_range
    label: "Date Range"
    default:
      preset: last_30_days
    options:
      presets:
        - last_7_days
        - last_30_days
        - last_90_days
        - this_month
        - last_month
      allow_custom: true
      max_range_days: 365
      
  - id: revenue_range
    dimension: "sales.total_revenue"
    type: range
    label: "Revenue Range"
    options:
      min: 0
      max: 10000000
      step: 100000
      format:
        style: currency
        currency: USD
        notation: compact
      histogram:
        show: true
        bins: 20
        
  - id: category_tree
    dimension: "product.category_path"
    type: tree
    label: "Product Category"
    multi: true
    options:
      expand_level: 1
      show_counts: true
      search: true
```

### 16.3 Variable Object

Variables allow user-configurable parameters beyond filters:

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | Identifier | REQUIRED | Unique variable identifier |
| `type` | string | REQUIRED | `text`, `number`, `boolean`, `select`, `date` |
| `label` | string | REQUIRED | Display label |
| `default` | any | REQUIRED | Default value |
| `description` | string | OPTIONAL | Help text |
| `options` | VariableOptions | OPTIONAL | Type-specific options |

```yaml
variables:
  - id: target_growth
    type: number
    label: "Target Growth Rate"
    description: "Annual growth target for comparison"
    default: 0.15
    options:
      min: 0
      max: 1
      step: 0.01
      format:
        style: percent
        
  - id: currency
    type: select
    label: "Display Currency"
    default: "USD"
    options:
      values:
        - value: "USD"
          label: "US Dollar"
        - value: "EUR"
          label: "Euro"
        - value: "GBP"
          label: "British Pound"
          
  - id: show_forecast
    type: boolean
    label: "Show Forecast"
    default: true
```

**Using Variables**:

```yaml
panels:
  - id: growth_comparison
    type: bar
    data:
      metrics:
        - ref: "sales.growth_rate"
    options:
      reference_lines:
        - type: constant
          value: "${var:target_growth}"
          label: "Target"
```

---

## 17. Theming

### 17.1 Theme Reference

```yaml
theme:
  ref: "corporate-dark"        # Reference external theme
```

### 17.2 Inline Theme

```yaml
theme:
  base: "light"                # light | dark | high_contrast
  
  colors:
    # Brand colors
    primary: "#1E88E5"
    secondary: "#26A69A"
    accent: "#FFC107"
    
    # Background colors
    background:
      primary: "#FFFFFF"
      secondary: "#F5F5F5"
      tertiary: "#EEEEEE"
      
    # Surface colors
    surface:
      primary: "#FFFFFF"
      elevated: "#FFFFFF"
      
    # Text colors
    text:
      primary: "#212121"
      secondary: "#666666"
      disabled: "#9E9E9E"
      inverse: "#FFFFFF"
      
    # Border colors
    border:
      primary: "#E0E0E0"
      secondary: "#EEEEEE"
      focus: "#1E88E5"
      
    # Semantic colors
    semantic:
      positive: "#4CAF50"
      negative: "#F44336"
      warning: "#FF9800"
      neutral: "#9E9E9E"
      info: "#2196F3"
      
    # Chart palettes
    categorical:
      - "#1E88E5"
      - "#26A69A"
      - "#FFA726"
      - "#AB47BC"
      - "#EC407A"
      - "#7E57C2"
      - "#5C6BC0"
      - "#29B6F6"
      
    sequential:
      blues:
        - "#E3F2FD"
        - "#90CAF9"
        - "#42A5F5"
        - "#1E88E5"
        - "#1565C0"
        - "#0D47A1"
        
    diverging:
      red_blue:
        negative:
          - "#FFCDD2"
          - "#E57373"
          - "#F44336"
          - "#C62828"
        neutral: "#FFFFFF"
        positive:
          - "#BBDEFB"
          - "#64B5F6"
          - "#1E88E5"
          - "#0D47A1"
          
  typography:
    font_family:
      base: "Inter, -apple-system, BlinkMacSystemFont, sans-serif"
      mono: "JetBrains Mono, Consolas, monospace"
      
    font_size:
      xs: "11px"
      sm: "12px"
      base: "14px"
      lg: "16px"
      xl: "20px"
      xxl: "24px"
      xxxl: "32px"
      
    font_weight:
      normal: 400
      medium: 500
      semibold: 600
      bold: 700
      
    line_height:
      tight: 1.25
      normal: 1.5
      relaxed: 1.75
      
    # Specific text styles
    heading:
      font_weight: 600
      letter_spacing: "-0.02em"
      
    metric:
      font_size: "32px"
      font_weight: 700
      font_variant_numeric: "tabular-nums"
      
    label:
      font_size: "12px"
      font_weight: 500
      text_transform: "uppercase"
      letter_spacing: "0.05em"
      
  spacing:
    unit: 8                    # Base unit in pixels
    xs: 4
    sm: 8
    md: 16
    lg: 24
    xl: 32
    xxl: 48
    
  borders:
    radius:
      none: 0
      sm: 4
      md: 8
      lg: 12
      full: 9999
    width:
      thin: 1
      medium: 2
      thick: 4
      
  shadows:
    none: "none"
    sm: "0 1px 2px rgba(0,0,0,0.05)"
    md: "0 4px 6px rgba(0,0,0,0.1)"
    lg: "0 10px 15px rgba(0,0,0,0.1)"
    xl: "0 20px 25px rgba(0,0,0,0.15)"
    
  motion:
    duration:
      instant: "0ms"
      fast: "100ms"
      normal: "200ms"
      slow: "300ms"
    easing:
      default: "cubic-bezier(0.4, 0, 0.2, 1)"
      in: "cubic-bezier(0.4, 0, 1, 1)"
      out: "cubic-bezier(0, 0, 0.2, 1)"
      
  # Chart-specific theming
  charts:
    background: "transparent"
    grid:
      color: "#E0E0E0"
      style: "dashed"
      width: 1
    axis:
      line_color: "#BDBDBD"
      label_color: "#666666"
      tick_color: "#BDBDBD"
    tooltip:
      background: "#FFFFFF"
      border_color: "#E0E0E0"
      border_radius: 8
      shadow: "0 4px 12px rgba(0,0,0,0.15)"
      text_color: "#212121"
    legend:
      text_color: "#666666"
```

### 17.3 Color Specification

Colors MUST be specified as:

| Format | Example | Alpha Support |
|--------|---------|---------------|
| Hex 6-digit | `"#4CAF50"` | No |
| Hex 8-digit | `"#4CAF50CC"` | Yes |
| RGB | `"rgb(76, 175, 80)"` | No |
| RGBA | `"rgba(76, 175, 80, 0.8)"` | Yes |
| HSL | `"hsl(122, 39%, 49%)"` | No |
| HSLA | `"hsla(122, 39%, 49%, 0.8)"` | Yes |
| Theme reference | `"theme:primary"` | Via reference |
| Semantic reference | `"theme:semantic.positive"` | Via reference |

**Color Space**: All colors are interpreted as sRGB unless explicitly specified.

---

## 18. Internationalisation

### 18.1 I18n Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `default_locale` | string | REQUIRED | BCP 47 language tag |
| `supported_locales` | string[] | OPTIONAL | Available locales |
| `fallback_locale` | string | OPTIONAL | Fallback if requested unavailable |
| `translations` | Translations | OPTIONAL | String translations |
| `formatting` | FormattingConfig | OPTIONAL | Locale-specific formatting |
| `rtl_locales` | string[] | OPTIONAL | Right-to-left locales |

### 18.2 Example

```yaml
i18n:
  default_locale: "en-GB"
  supported_locales:
    - "en-GB"
    - "en-US"
    - "de-DE"
    - "fr-FR"
    - "ja-JP"
    - "ar-SA"
  fallback_locale: "en-GB"
  rtl_locales:
    - "ar-SA"
    - "he-IL"
    
  translations:
    dashboard:
      title:
        en-GB: "Sales Performance"
        en-US: "Sales Performance"
        de-DE: "Verkaufsleistung"
        fr-FR: "Performance des ventes"
        ja-JP: ""
        ar-SA: " "
      description:
        en-GB: "Executive overview of sales metrics"
        de-DE: "Fhrungsbersicht der Verkaufskennzahlen"
        
    panels:
      revenue_kpi:
        title:
          en-GB: "Total Revenue"
          de-DE: "Gesamtumsatz"
          fr-FR: "Revenu total"
          ja-JP: ""
          
    filters:
      region_filter:
        label:
          en-GB: "Region"
          de-DE: "Region"
          fr-FR: "Rgion"
          ja-JP: ""
          
  formatting:
    # Override locale defaults
    en-GB:
      number:
        decimal_separator: "."
        thousands_separator: ","
      date:
        short: "DD/MM/YYYY"
        long: "D MMMM YYYY"
        time: "HH:mm"
      currency:
        default: "GBP"
        
    de-DE:
      number:
        decimal_separator: ","
        thousands_separator: "."
      date:
        short: "DD.MM.YYYY"
        long: "D. MMMM YYYY"
      currency:
        default: "EUR"
        
    ja-JP:
      date:
        short: "YYYY/MM/DD"
        long: "YYYYMD"
```

### 18.3 Translatable Fields

The following fields support translation references:

- `dashboard.title`
- `dashboard.description`
- `panel.title`
- `panel.description`
- `filter.label`
- `variable.label`
- `variable.description`
- `alert.name`
- `alert.message`
- `section.title`
- `tab.title`

**Translation Reference Syntax**:

```yaml
title: "${t:panels.revenue_kpi.title}"
```

---

## 19. Access Control

### 19.1 Access Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `visibility` | string | OPTIONAL | `public`, `authenticated`, `restricted` |
| `owner` | string | OPTIONAL | Owner identifier |
| `inherit_rls` | boolean | OPTIONAL | Inherit row-level security from semantic layer |
| `roles` | RoleAccess[] | OPTIONAL | Role-based access rules |
| `panel_access` | PanelAccess[] | OPTIONAL | Panel-level restrictions |
| `data_masking` | DataMasking[] | OPTIONAL | Field masking rules |
| `export_restrictions` | ExportRestrictions | OPTIONAL | Export limitations |

### 19.2 Example

```yaml
access:
  visibility: restricted
  owner: "data-team@example.com"
  
  inherit_rls: true           # Use semantic layer RLS
  
  roles:
    - role: "executive"
      permissions:
        - view
        - export
    - role: "analyst"
      permissions:
        - view
        - export
        - modify_filters
    - role: "admin"
      permissions:
        - view
        - export
        - modify_filters
        - edit
        - delete
        
  panel_access:
    - panel: "cost_breakdown"
      roles:
        - "finance"
        - "executive"
    - panel: "employee_metrics"
      roles:
        - "hr"
        - "executive"
        
  data_masking:
    - dimension: "customer.email"
      type: partial
      pattern: "***@{domain}"
      roles_exempt:
        - "admin"
        - "support"
    - dimension: "customer.phone"
      type: full
      replacement: "***-***-****"
      roles_exempt:
        - "admin"
        
  export_restrictions:
    allowed_formats:
      - pdf
      - png
    disallowed_formats:
      - csv
      - xlsx
    row_limit: 10000
    watermark:
      enabled: true
      text: "Confidential - ${user.email}"
```

### 19.3 Row-Level Security

When `inherit_rls: true`, the semantic layer's row-level security is applied. For dashboards requiring additional RLS:

```yaml
access:
  inherit_rls: true
  
  additional_rls:
    - dimension: "geography.region"
      policy:
        type: user_attribute
        attribute: "assigned_regions"
        operator: in
        
    - dimension: "org.department"
      policy:
        type: expression
        expression: |
          CASE 
            WHEN user.role = 'executive' THEN true
            WHEN user.role = 'manager' THEN org.department = user.department
            ELSE false
          END
```

---

## 20. Alerts and Notifications

### 20.1 Alert Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | Identifier | REQUIRED | Unique alert identifier |
| `name` | string | REQUIRED | Alert name |
| `description` | string | OPTIONAL | Alert description |
| `enabled` | boolean | OPTIONAL | Enable/disable (default: true) |
| `condition` | AlertCondition | REQUIRED | Trigger condition |
| `severity` | string | REQUIRED | `info`, `warning`, `critical` |
| `notifications` | Notification[] | REQUIRED | Notification channels |
| `schedule` | Schedule | OPTIONAL | Check schedule |
| `cooldown` | integer | OPTIONAL | Seconds between re-alerts |
| `auto_resolve` | boolean | OPTIONAL | Auto-resolve when condition clears |

### 20.2 Alert Condition

```yaml
alerts:
  - id: revenue_drop
    name: "Significant Revenue Drop"
    description: "Revenue dropped more than 15% compared to previous period"
    severity: critical
    
    condition:
      type: comparison
      metric:
        ref: "sales.total_revenue"
      comparison:
        type: previous_period
        operator: lt
        value: -0.15           # 15% drop
        
    notifications:
      - channel: email
        recipients:
          - "sales-leadership@example.com"
          - "cfo@example.com"
        template: "revenue_alert"
        
      - channel: slack
        webhook_env: "SLACK_ALERTS_WEBHOOK"
        channel: "#sales-alerts"
        
      - channel: webhook
        url_env: "PAGERDUTY_WEBHOOK"
        method: POST
        headers:
          Content-Type: "application/json"
        body_template: |
          {
            "summary": "${alert.name}",
            "severity": "${alert.severity}",
            "source": "${dashboard.title}"
          }
          
    schedule:
      type: cron
      expression: "0 9 * * 1-5"  # 9am weekdays
      timezone: "Europe/London"
      
    cooldown: 86400             # 24 hours
    auto_resolve: true

  - id: target_achieved
    name: "Quarterly Target Achieved"
    severity: info
    
    condition:
      type: threshold
      metric:
        ref: "sales.quota_attainment"
      operator: gte
      value: 1.0
      
    notifications:
      - channel: email
        recipients:
          - "sales-team@example.com"
          
  - id: anomaly_detected
    name: "Unusual Activity Detected"
    severity: warning
    
    condition:
      type: anomaly
      metric:
        ref: "events.transaction_count"
      sensitivity: medium        # low | medium | high
      direction: both            # up | down | both
```

---

## 21. Embedding

### 21.1 Embedding Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `enabled` | boolean | REQUIRED | Allow embedding |
| `authentication` | EmbedAuth | REQUIRED | Auth configuration |
| `allowed_origins` | string[] | OPTIONAL | Allowed parent origins |
| `styling` | EmbedStyling | OPTIONAL | Style inheritance |
| `events` | EmbedEvents | OPTIONAL | Event communication |
| `sandbox` | SandboxConfig | OPTIONAL | Security restrictions |
| `responsive` | ResponsiveConfig | OPTIONAL | Responsive behaviour |

### 21.2 Example

```yaml
embedding:
  enabled: true
  
  authentication:
    type: signed_token          # signed_token | api_key | public | sso_passthrough
    
    # For signed_token
    token:
      algorithm: HS256
      secret_env: "EMBED_JWT_SECRET"
      expiry: 3600              # Seconds
      claims:
        required:
          - "sub"               # User ID
          - "exp"               # Expiry
        optional:
          - "email"
          - "roles"
          - "filters"         # Pre-applied filters
          
    # For SSO passthrough
    sso:
      provider: oidc
      claims_mapping:
        user_id: "sub"
        email: "email"
        roles: "groups"
        
  allowed_origins:
    - "https://app.example.com"
    - "https://*.example.com"
    
  styling:
    inherit_parent: true
    containment: strict         # strict | style | none
    css_variables:
      - "--uds-primary"
      - "--uds-background"
      - "--uds-text"
    custom_css:
      enabled: false
      allowed_properties:
        - "font-family"
        - "border-radius"
        
  events:
    emit:
      - event: filter_changed
        payload:
          - dimension
          - values
          - source_panel
      - event: drill_through
        payload:
          - target_dashboard
          - context
      - event: data_loaded
        payload:
          - panel_id
          - row_count
      - event: error
        payload:
          - error_code
          - message
          - panel_id
          
    receive:
      - event: set_filter
        handler: apply_filter
        schema:
          dimension: string
          operator: string
          values: array
      - event: set_time_range
        handler: apply_time_range
      - event: refresh
        handler: refresh_all
      - event: export
        handler: trigger_export
        
  sandbox:
    allow_scripts: false
    allow_forms: false
    allow_popups: false
    allow_top_navigation: false
    allow_downloads: true
    
  responsive:
    mode: fill                  # fill | fixed | responsive
    min_width: 320
    min_height: 400
    breakpoints:
      compact:
        max_width: 600
        hide_panels:
          - secondary_chart
        collapse_filters: true
      full:
        min_width: 601---

# Universal Dashboard Specification - Part 2

**Sections 22-35: Error Handling through Appendices**

---

## 22. Error Handling

Error handling defines behaviour when things go wrong. Conformant renderers MUST implement these behaviours.

### 22.1 ErrorHandling Object (Dashboard Level)

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `source_unavailable` | ErrorBehaviour | OPTIONAL | Semantic source unreachable |
| `authentication_failed` | ErrorBehaviour | OPTIONAL | Auth failure |
| `query_failed` | ErrorBehaviour | OPTIONAL | Query execution error |
| `timeout` | ErrorBehaviour | OPTIONAL | Request timeout |
| `empty_data` | ErrorBehaviour | OPTIONAL | Query returns no rows |
| `partial_failure` | ErrorBehaviour | OPTIONAL | Some panels fail |
| `global_fallback` | ErrorBehaviour | OPTIONAL | Default for unspecified errors |

### 22.2 ErrorBehaviour Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `display` | string | REQUIRED | `message`, `placeholder`, `hide`, `retry`, `fallback` |
| `message` | string | CONDITIONAL | Error message to display |
| `message_i18n` | string | OPTIONAL | Translation key for message |
| `retry` | RetryConfig | OPTIONAL | Retry configuration |
| `fallback` | FallbackConfig | OPTIONAL | Fallback data/display |
| `log` | boolean | OPTIONAL | Log error (default: true) |
| `notify` | boolean | OPTIONAL | Trigger error notification |

### 22.3 Complete Example

```yaml
error_handling:
  source_unavailable:
    display: message
    message: "Unable to connect to data source. Retrying..."
    retry:
      enabled: true
      max_attempts: 3
      initial_delay: 1000       # Milliseconds
      backoff: exponential      # linear | exponential
      max_delay: 30000
    fallback:
      type: cached
      max_age: 3600             # Use cache up to 1 hour old
      stale_indicator: true
      
  authentication_failed:
    display: message
    message: "Session expired. Please refresh the page."
    retry:
      enabled: false
    log: true
    notify: true
    
  query_failed:
    display: message
    message: "Error loading data: ${error.message}"
    retry:
      enabled: true
      max_attempts: 2
      
  timeout:
    display: retry
    message: "Request timed out"
    retry:
      enabled: true
      max_attempts: 2
      
  empty_data:
    display: message
    message: "No data available for the selected filters"
    message_i18n: "errors.empty_data"
    
  partial_failure:
    display: message
    message: "Some data could not be loaded"
    # Continue showing panels that succeeded
    
  global_fallback:
    display: placeholder
    message: "An error occurred"
```

### 22.4 Panel-Level Error Override

```yaml
panels:
  - id: critical_kpi
    type: kpi
    # ...
    
    error_handling:
      query_failed:
        display: fallback
        fallback:
          type: static
          value: "N/A"
          style: warning
          
      empty_data:
        display: fallback
        fallback:
          type: static
          value: 0
          annotation: "No transactions in period"
```

### 22.5 Error Codes

Conformant implementations MUST use these error codes:

Conformant implementations MUST use these error codes:

| Code | Name | Description |
|------|------|-------------|
| `UDS-E001` | SOURCE_UNAVAILABLE | Semantic source unreachable |
| `UDS-E002` | AUTH_FAILED | Authentication failure |
| `UDS-E003` | AUTH_EXPIRED | Token/session expired |
| `UDS-E004` | FORBIDDEN | Insufficient permissions |
| `UDS-E005` | QUERY_FAILED | Query execution error |
| `UDS-E006` | QUERY_TIMEOUT | Query timed out |
| `UDS-E007` | INVALID_METRIC | Metric reference not found |
| `UDS-E008` | INVALID_DIMENSION | Dimension reference not found |
| `UDS-E009` | INVALID_FILTER | Invalid filter expression |
| `UDS-E010` | DATA_TYPE_MISMATCH | Incompatible data types |
| `UDS-E011` | ROW_LIMIT_EXCEEDED | Query exceeded row limit |
| `UDS-E012` | RATE_LIMITED | Too many requests |
| `UDS-E013` | RENDER_FAILED | Visualisation render error |
| `UDS-E014` | EXPORT_FAILED | Export generation error |
| `UDS-E015` | SCHEMA_INVALID | Document validation error |
| `UDS-E020` | MISSING_BINDING | Required binding not provided |
| `UDS-E021` | BINDING_NOT_IN_DATA | Binding references field not in data block |
| `UDS-E022` | BINDING_TYPE_MISMATCH | Binding references wrong field type |
| `UDS-E023` | BINDING_INVALID_PARENT | Parent reference binding has invalid values |
| `UDS-E024` | BINDING_CIRCULAR | Circular parent reference detected |

## 23. AI Generation

### 23.1 Generation Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `mode` | string | REQUIRED | `full`, `assisted`, `template` |
| `model` | string | OPTIONAL | Preferred AI model identifier |
| `constraints` | GenerationConstraints | OPTIONAL | Hard constraints |
| `preferences` | GenerationPreferences | OPTIONAL | Soft preferences |
| `candidate_metrics` | string[] | OPTIONAL | Metrics to consider |
| `required_metrics` | string[] | OPTIONAL | Metrics that must appear |
| `excluded_metrics` | string[] | OPTIONAL | Metrics to exclude |
| `candidate_dimensions` | string[] | OPTIONAL | Dimensions to consider |
| `required_dimensions` | string[] | OPTIONAL | Dimensions that must appear |
| `context` | GenerationContext | OPTIONAL | Additional context |

### 23.2 Generation Modes

| Mode | Description |
|------|-------------|
| `full` | AI generates complete dashboard from intent |
| `assisted` | AI suggests additions/improvements to partial dashboard |
| `template` | AI selects and customises from predefined templates |

### 23.3 Constraints

```yaml
generation:
  mode: full
  
  constraints:
    # Panel limits
    max_panels: 8
    min_panels: 3
    max_kpis: 5
    
    # Layout constraints
    require_kpi_row: true
    require_trend: true
    max_columns: 2              # For table-heavy dashboards
    
    # Type restrictions
    allowed_types:
      - kpi
      - trend
      - bar
      - table
    prohibited_types:
      - pie                     # No pie charts
      - map                     # No maps
      
    # Complexity
    max_dimensions_per_panel: 3
    max_metrics_per_panel: 5
    max_series: 8
    
    # Data constraints
    max_rows: 10000
    require_time_dimension: true
```

### 23.4 Preferences

```yaml
generation:
  preferences:
    # Visual style
    chart_style: minimal        # minimal | detailed | infographic
    color_usage: semantic       # semantic | categorical | monochrome
    density: comfortable        # compact | comfortable | spacious
    
    # Chart preferences
    prefer_horizontal_bars: true
    prefer_area_over_line: true
    show_data_labels: false
    
    # Layout preferences
    kpi_position: top
    trend_position: middle
    table_position: bottom
    
    # Comparison
    default_comparison: previous_period
    show_targets: true
    
    # Interactivity
    enable_drill_down: true
    enable_cross_filter: true
```

### 23.5 Generation Context

```yaml
generation:
  context:
    # Business context
    industry: "retail"
    business_unit: "e-commerce"
    
    # Temporal context
    reporting_frequency: "weekly"
    fiscal_calendar: true
    
    # User context
    user_role: "regional_manager"
    expertise_level: "intermediate"
    
    # Data context
    data_freshness: "daily"
    data_quality_notes: "Customer data may have duplicates"
    
    # Additional guidance
    guidance: |
      Focus on conversion funnel metrics.
      Compare desktop vs mobile performance.
      Highlight any metrics that deviate >20% from target.
      
    # Examples of good dashboards
    reference_dashboards:
      - id: "sales-dashboard-2025"
        relevance: "Similar metrics, good layout"
      - id: "marketing-weekly"
        relevance: "Good use of comparisons"
```

### 23.6 AI-Generated Explanation

Conformant generators MUST include explanation metadata:

```yaml
# Generator adds this to output
_generation:
  model: "uds-gen-v1.2"
  model_version: "1.2.0"
  timestamp: "2026-01-11T10:30:00Z"
  generation_id: "gen_abc123"
  
  # Overall confidence
  confidence: 0.87
  
  # Per-panel explanations
  explanations:
    - panel_id: revenue_trend
      type_selected: trend
      type_confidence: 0.92
      reasoning: |
        Selected trend (area) chart for revenue over time because:
        - Single metric with time dimension suggests trend
        - Executive persona prefers area fill for visual weight
        - 12 time periods is optimal for trend identification
      alternatives:
        - type: bar
          confidence: 0.71
          trade_off: "Less effective for showing continuity"
        - type: table
          confidence: 0.45
          trade_off: "Loses visual pattern recognition"
          
    - panel_id: region_comparison
      type_selected: bar
      type_confidence: 0.88
      reasoning: |
        Selected horizontal bar chart because:
        - Comparing 8 regions (categorical)
        - Region names are long, horizontal fits better
        - Sorted by value for easy ranking
        
  # Layout explanation
  layout_reasoning: |
    Arranged panels in Z-pattern reading flow:
    - KPIs at top for immediate summary
    - Trend in prominent middle position
    - Regional breakdown supports drill-down
    
  # Suggestions for improvement
  suggestions:
    - type: add_panel
      suggestion: "Consider adding customer segment breakdown"
      confidence: 0.65
      reason: "Churn rate varies significantly by segment"
      
    - type: modify_panel
      panel_id: region_comparison
      suggestion: "Add target reference line"
      confidence: 0.78
      reason: "Targets available in semantic layer"
      
  # Warnings
  warnings:
    - type: data_quality
      message: "Revenue data has 3% null values in selected period"
      severity: low
      
    - type: metric_coverage
      message: "Only 4 of 8 candidate metrics used"
      severity: info
```

---

## 24. Document Lifecycle

### 24.1 Lifecycle Object

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `status` | string | REQUIRED | Current lifecycle status |
| `created_at` | datetime | REQUIRED | Creation timestamp |
| `created_by` | string | OPTIONAL | Creator identifier |
| `published_at` | datetime | OPTIONAL | Publication timestamp |
| `published_by` | string | OPTIONAL | Publisher identifier |
| `deprecated_at` | datetime | OPTIONAL | Deprecation timestamp |
| `sunset_at` | datetime | OPTIONAL | End-of-life date |
| `replacement` | string | OPTIONAL | Replacement dashboard ID |
| `migration_guide` | string | OPTIONAL | Migration documentation URL |
| `review` | ReviewConfig | OPTIONAL | Review/approval workflow |
| `variants` | Variant[] | OPTIONAL | A/B test variants |

### 24.2 Status Values

| Status | Description |
|--------|-------------|
| `draft` | Work in progress, not visible to end users |
| `review` | Pending review/approval |
| `published` | Active and visible |
| `deprecated` | Still functional but scheduled for removal |
| `archived` | No longer functional, preserved for reference |

### 24.3 Example

```yaml
lifecycle:
  status: published
  
  created_at: "2025-06-15T10:00:00Z"
  created_by: "jane.smith@example.com"
  
  published_at: "2025-06-20T14:30:00Z"
  published_by: "data-governance@example.com"
  
  review:
    required: true
    reviewers:
      - "data-governance@example.com"
      - "finance-lead@example.com"
    approval_count: 2
    last_review:
      date: "2025-12-01T09:00:00Z"
      reviewer: "data-governance@example.com"
      status: approved
      comments: "Annual review completed. No changes needed."
    next_review: "2026-06-01"
    
  # For deprecated dashboards
  # deprecated_at: "2026-03-01T00:00:00Z"
  # sunset_at: "2026-06-01T00:00:00Z"
  # replacement: "sales-dashboard-v3"
  # migration_guide: "https://docs.example.com/migrate-sales-v2-to-v3"
```

### 24.4 A/B Testing Variants

```yaml
lifecycle:
  status: published
  
  variants:
    - id: control
      name: "Current Design"
      weight: 0.8                # 80% of traffic
      
    - id: treatment_a
      name: "New KPI Layout"
      weight: 0.1
      changes:
        - type: panel_option
          panel_id: revenue_kpi
          path: "options.layout.value_size"
          value: "xlarge"
          
        - type: panel_position
          panel_id: trend_chart
          position:
            row: 0
            column: 4
            width: 8
            height: 4
            
    - id: treatment_b
      name: "Simplified View"
      weight: 0.1
      changes:
        - type: remove_panel
          panel_id: secondary_breakdown
          
        - type: panel_option
          panel_id: main_table
          path: "options.pagination.page_size"
          value: 10
          
  variant_assignment:
    method: user_hash           # user_hash | random | parameter
    hash_field: "user_id"
    sticky: true                # Same user always sees same variant
    
  variant_metrics:
    track:
      - event: page_view
      - event: filter_change
      - event: drill_down
      - event: export
    analysis_start: "2026-01-15T00:00:00Z"
    analysis_end: "2026-02-15T00:00:00Z"
```

---

## 25. Extension Mechanism

### 25.1 Extension Namespaces

Platform-specific features use `x-` prefixed namespaces:

```yaml
dashboard:
  title: "Sales Dashboard"
  
  # Standard UDS properties
  layout:
    type: grid
    columns: 12
    
  # Grafana-specific extensions
  x-grafana:
    uid: "abc123"
    folder_uid: "sales"
    tags:
      - "production"
      - "sales"
    annotations:
      - datasource: prometheus
        enable: true
        name: "Deployments"
        query: "deployment_events"
        
  # Tableau-specific extensions
  x-tableau:
    project: "Sales Analytics"
    site: "default"
    extract_refresh: "0 6 * * *"
```

### 25.2 Custom Visualisation Types

```yaml
panels:
  - id: custom_viz
    type: "x-acme/waterfall"    # Extension namespace
    
    # Standard properties still apply
    title: "Revenue Waterfall"
    position:
      row: 0
      column: 0
      width: 12
      height: 4
      
    data:
      source: sales
      metrics:
        - ref: "sales.total_revenue"
      dimensions:
        - ref: "sales.revenue_component"
        
    # Extension-specific options
    x-acme:
      waterfall:
        start_label: "Starting Revenue"
        end_label: "Ending Revenue"
        positive_color: "#4CAF50"
        negative_color: "#F44336"
        connector_style: "dashed"
```

### 25.3 Extension Registration

Extensions SHOULD be registered with metadata:

```yaml
# acme-waterfall.extension.yaml
uds_extension: "0.1.0"

extension:
  namespace: "x-acme"
  name: "waterfall"
  version: "1.2.0"
  vendor: "ACME Analytics Inc."
  documentation: "https://acme.example.com/uds-extensions/waterfall"
  
  description: |
    Waterfall chart visualisation showing cumulative effect
    of sequential positive and negative values.
    
  panel_type:
    name: "waterfall"
    category: "comparison"
    icon: "waterfall_chart"
    
    # Required data shape
    data_requirements:
      metrics:
        min: 1
        max: 1
        types:
          - numeric
      dimensions:
        min: 1
        max: 1
        types:
          - categorical
          
    # Options schema
    options_schema:
      type: object
      properties:
        start_label:
          type: string
          default: "Start"
        end_label:
          type: string
          default: "End"
        positive_color:
          type: string
          format: color
          default: "#4CAF50"
        negative_color:
          type: string
          format: color
          default: "#F44336"
        show_connectors:
          type: boolean
          default: true
        connector_style:
          type: string
          enum: ["solid", "dashed", "dotted"]
          default: "solid"
          
    # Accessibility requirements
    accessibility:
      requires_alt_text: true
      requires_data_table: true
      
    # Fallback for non-supporting renderers
    fallback:
      type: bar
      transform: |
        Convert categories to stacked bar with positive/negative encoding
```

---

## 26. Compilation Targets

### 26.1 Target Registry

| Target | Status | Description |
|--------|--------|-------------|
| `uds-native` | Reference | Native UDS runtime |
| `grafana` | Supported | Grafana Dashboard JSON |
| `metabase` | Supported | Metabase Card/Dashboard API |
| `superset` | Supported | Apache Superset |
| `vega-lite` | Supported | Vega-Lite specifications |
| `tableau` | Planned | Tableau workbook |
| `powerbi` | Planned | Power BI report |
| `html` | Supported | Static HTML export |
| `pdf` | Supported | PDF document |
| `png` | Supported | PNG image |

### 26.2 Compilation Configuration

```yaml
compilation:
  default_target: uds-native
  
  targets:
    - type: grafana
      version: "10.x"
      options:
        dashboard_uid: "sales-q4-2026"
        folder_uid: "sales-dashboards"
        overwrite: true
        
    - type: vega-lite
      version: "5.x"
      options:
        renderer: svg           # svg | canvas
        standalone: true
        include_data: false
        
    - type: pdf
      options:
        page_size: A4
        orientation: landscape
        include_timestamp: true
        include_filters: true
        watermark: null
```

### 26.3 Feature Support Matrix

Compilers MUST publish feature support:

```yaml
# grafana-compiler-manifest.yaml
compiler:
  name: "UDS to Grafana Compiler"
  target: grafana
  target_versions:
    - "9.x"
    - "10.x"
    - "11.x"
  compiler_version: "1.0.0"
  uds_version: "0.1.0"
  
  feature_support:
    panel_types:
      kpi:
        support: full
        notes: "Uses Stat panel"
      trend:
        support: full
        notes: "Uses Time series panel"
      bar:
        support: full
        notes: "Uses Bar chart panel"
      table:
        support: full
      pie:
        support: full
      scatter:
        support: partial
        limitations:
          - "Size encoding not supported"
      map:
        support: partial
        limitations:
          - "Requires Geomap panel plugin"
      sankey:
        support: none
        fallback: table
        
    layout:
      grid:
        support: full
      sections:
        support: partial
        notes: "Maps to row panels"
      tabs:
        support: none
        fallback: "Separate dashboards"
        
    interactivity:
      drill_down:
        support: full
        notes: "Uses data links"
      cross_filter:
        support: partial
        limitations:
          - "Requires dashboard variables"
      drill_through:
        support: full
        
    theming:
      colors:
        support: full
      typography:
        support: partial
        
    i18n:
      support: none
      
    access_control:
      support: partial
      notes: "Basic folder/dashboard permissions"
```

---

## 27. Security Considerations

### 27.1 Credential Handling

1. Authentication credentials MUST NOT be stored in UDS documents
2. Use environment variable references for all secrets
3. Implementations MUST NOT log credential values
4. Token expiry SHOULD be enforced

### 27.2 Data Exposure

1. UDS documents MAY contain sensitive business logic
2. Filter values MUST be parameterised, never string-interpolated
3. Custom expressions MUST be validated against safe operation allowlist
4. Row-level security MUST be enforced at semantic layer

### 27.3 Injection Prevention

```yaml
# CORRECT: Parameterised filter
filters:
  - dimension: "customer.name"
    operator: eq
    value: "${filter.customer}"   # Parameterised

# NEVER: String interpolation (not valid UDS)
# query: "WHERE name = '${user_input}'"
```

### 27.4 Content Security

1. Text panel HTML MUST be sanitised
2. External URLs MUST be validated against allowlist when configured
3. Exported files MUST prevent formula injection
4. Embedded dashboards MUST respect CSP headers

### 27.5 Audit Requirements

Implementations SHOULD support:

```yaml
audit:
  enabled: true
  
  events:
    - dashboard_viewed
    - filter_changed
    - data_exported
    - drill_through
    - dashboard_modified
    - access_denied
    
  retention_days: 90
  
  include:
    - timestamp
    - user_id
    - session_id
    - ip_address
    - user_agent
    - event_details
```

---

## 28. Accessibility

### 28.1 WCAG 2.1 Level AA Compliance

Conformant renderers MUST meet WCAG 2.1 Level AA. This section specifies UDS-specific requirements.

### 28.2 Required Panel Properties

```yaml
panels:
  - id: revenue_trend
    type: trend
    title: "Revenue Over Time"              # REQUIRED
    description: |                          # REQUIRED for charts
      Monthly revenue from January to December 2025,
      showing 23% year-over-year growth with peak
      in November due to holiday sales.
      
    accessibility:
      alt_text: |                           # REQUIRED
        Line chart showing revenue trend. Revenue
        increased from $1.2M in January to $1.5M
        in December, with highest point of $1.8M
        in November.
        
      data_table:
        enabled: true                       # REQUIRED for charts
        caption: "Monthly Revenue Data 2025"
        summary: "12 rows showing month and revenue"
        
      keyboard:
        navigable: true                     # REQUIRED
        focus_order: 3                      # Tab order position
        
      announcements:
        on_load: "Revenue chart loaded. Use arrow keys to navigate data points."
        on_update: "Data refreshed. Revenue is now ${value}."
```

### 28.3 Color Requirements

```yaml
theme:
  colors:
    # Text on background: minimum 4.5:1 contrast
    text:
      primary: "#212121"        # On #FFFFFF = 16.1:1 
      secondary: "#666666"      # On #FFFFFF = 5.7:1 
      
    # Graphical elements: minimum 3:1 contrast
    chart:
      line: "#1E88E5"          # On #FFFFFF = 4.5:1 
      
    # Never use color alone
    semantic:
      positive:
        color: "#4CAF50"
        pattern: "solid"
        icon: "arrow_up"
      negative:
        color: "#F44336"
        pattern: "dashed"
        icon: "arrow_down"
```

### 28.4 Reduced Motion

```yaml
theme:
  motion:
    respect_reduced_motion: true    # REQUIRED
    
    # Applied when prefers-reduced-motion: reduce
    reduced:
      duration:
        instant: "0ms"
        fast: "0ms"
        normal: "0ms"
        slow: "0ms"
      transitions: false
      animations: false
```

### 28.5 Screen Reader Support

Implementations MUST provide:

1. Semantic HTML structure (headings, landmarks, lists)
2. ARIA labels for all interactive elements
3. Live regions for dynamic updates
4. Skip links for keyboard navigation
5. Data tables as alternative to all visualisations

---

## 29. Conformance

### 29.1 Conformance Levels

| Level | Description | Requirements |
|-------|-------------|--------------|
| **UDS Core** | Minimum viable | All REQUIRED features |
| **UDS Standard** | Production-ready | Core + all RECOMMENDED |
| **UDS Complete** | Full-featured | Standard + all OPTIONAL |

### 29.2 Conformance Classes

| Class | Description |
|-------|-------------|
| **UDS Document** | Valid UDS document |
| **UDS Parser** | Reads and validates UDS documents |
| **UDS Renderer** | Renders UDS documents visually |
| **UDS Generator** | Creates UDS documents from input |
| **UDS Compiler** | Converts UDS to other formats |

### 29.3 Required Test Coverage

Conformance tests are organised by category:

| Category | Core Tests | Standard Tests | Complete Tests |
|----------|------------|----------------|----------------|
| Schema Validation | 150 | 250 | 400 |
| Panel Types | 60 | 120 | 200 |
| Layout | 40 | 80 | 120 |
| Data Binding | 80 | 150 | 250 |
| Interactivity | 30 | 100 | 180 |
| Theming | 20 | 60 | 100 |
| Accessibility | 50 | 100 | 150 |
| Error Handling | 40 | 80 | 120 |
| **Total** | **470** | **940** | **1520** |

### 29.4 Conformance Declaration

```yaml
# Conformance statement
conformance:
  implementation: "AcmeDash Renderer"
  vendor: "Acme Analytics"
  version: "2.1.0"
  
  specification: "UDS 0.1.0"
  level: standard
  
  tested:
    date: "2026-01-15"
    suite_version: "0.1.0"
    results:
      core: 470/470
      standard: 938/940
      complete: null          # Not tested
      
  notes:
    - "Scatter size encoding limited to 5 discrete sizes"
    - "Map panel requires additional plugin"
    
  contact: "support@acme.example.com"
```

---

## 30. Versioning

### 30.1 Specification Versioning

UDS follows [Semantic Versioning 2.0.0](https://semver.org/):

- **MAJOR** (X.0.0): Breaking changes
- **MINOR** (0.X.0): New features, backwards compatible
- **PATCH** (0.0.X): Bug fixes, clarifications

### 30.2 Version Compatibility

| Document Version | Renderer Version | Compatibility |
|------------------|------------------|---------------|
| 0.1.x | 0.1.x | Full |
| 0.1.x | 0.2.x | Full (backwards compatible) |
| 0.2.x | 0.1.x | Partial (new features ignored) |
| 0.x.x | 1.x.x | Requires migration |

### 30.3 Deprecation Policy

1. Features MUST be deprecated for at least one MINOR version before removal
2. Deprecated features MUST trigger warnings, not errors
3. Migration guides MUST be published with deprecations
4. Breaking changes MUST have automated migration tools

### 30.4 Version Negotiation

```yaml
uds: "0.1.0"

# Declare compatibility range
compatibility:
  min_version: "0.1.0"
  max_version: "0.2.x"        # Accept any 0.2.x
  
  # Features requiring specific versions
  required_features:
    - feature: "ai_generation"
      min_version: "0.1.0"
    - feature: "sankey_panel"
      min_version: "0.2.0"
```

---

## 31. IANA Considerations

### 31.1 Media Type Registration

This specification registers the following media types with IANA:

**application/vnd.uds+yaml**
- Type name: application
- Subtype name: vnd.uds+yaml
- Required parameters: none
- Optional parameters: version
- Encoding: UTF-8
- Security considerations: See Section 27

**application/vnd.uds+json**
- Type name: application
- Subtype name: vnd.uds+json
- Required parameters: none
- Optional parameters: version
- Encoding: UTF-8
- Security considerations: See Section 27

### 31.2 URI Scheme

UDS document references use standard HTTPS URIs:

```
https://uds.dev/schema/0.1.0/dashboard.json
https://uds.dev/themes/corporate-dark.theme.yaml
https://uds.dev/extensions/registry.json
```

---

## 32. References

### 32.1 Normative References

- [RFC 2119](https://www.rfc-editor.org/rfc/rfc2119) Key words for RFCs
- [RFC 8174](https://www.rfc-editor.org/rfc/rfc8174) Ambiguity of Uppercase
- [RFC 8259](https://www.rfc-editor.org/rfc/rfc8259) JSON
- [YAML 1.2](https://yaml.org/spec/1.2.2/) YAML Specification
- [JSON Schema Draft 2020-12](https://json-schema.org/draft/2020-12/schema)
- [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) Date/Time
- [ISO 4217](https://www.iso.org/iso-4217-currency-codes.html) Currency Codes
- [BCP 47](https://www.rfc-editor.org/info/bcp47) Language Tags
- [WCAG 2.1](https://www.w3.org/TR/WCAG21/) Web Content Accessibility

### 32.2 Informative References

- [Vega-Lite](https://vega.github.io/vega-lite/) Grammar of Graphics
- [Open Semantic Interchange](https://github.com/open-semantic-interchange/osi)
- [Cube Semantic Layer](https://cube.dev/)
- [dbt Semantic Layer](https://docs.getdbt.com/docs/use-dbt-semantic-layer/dbt-sl)

---

## Appendix A: Complete JSON Schema

The complete JSON Schema is available at:

**https://uds.dev/schema/0.1.0/dashboard.json**

Schema is approximately 3,500 lines. Key excerpts:

```json
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://uds.dev/schema/0.1.0/dashboard.json",
  "title": "Universal Dashboard Specification",
  "description": "Schema for UDS dashboard documents",
  "type": "object",
  
  "required": ["uds", "dashboard"],
  
  "properties": {
    "uds": {
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)$",
      "description": "UDS specification version"
    },
    
    "$schema": {
      "type": "string",
      "format": "uri"
    },
    
    "metadata": {
      "$ref": "#/$defs/Metadata"
    },
    
    "dashboard": {
      "$ref": "#/$defs/Dashboard"
    },
    
    "extensions": {
      "type": "object",
      "additionalProperties": true
    }
  },
  
  "$defs": {
    "Dashboard": {
      "type": "object",
      "required": ["title", "intent", "persona", "semantic_sources", "layout", "panels"],
      "properties": {
        "title": {
          "type": "string",
          "maxLength": 200
        },
        "intent": {
          "type": "string",
          "maxLength": 500
        },
        "persona": {
          "$ref": "#/$defs/Persona"
        }
      }
    },
    
    "Persona": {
      "oneOf": [
        {
          "type": "object",
          "required": ["type"],
          "properties": {
            "type": {
              "enum": ["executive", "manager", "analyst", "operator", "external"]
            }
          }
        },
        {
          "type": "object",
          "required": ["type", "id", "characteristics"],
          "properties": {
            "type": {
              "const": "custom"
            },
            "id": {
              "$ref": "#/$defs/Identifier"
            },
            "characteristics": {
              "$ref": "#/$defs/Characteristics"
            }
          }
        }
      ]
    },
    
    "Identifier": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9_.-]*$",
      "maxLength": 64
    }
  }
}
```

---

## Appendix B: Examples

### B.1 Minimal Valid Dashboard

```yaml
uds: "0.1.0"

dashboard:
  title: "Simple KPI Dashboard"
  intent: "Display key revenue metric"
  
  persona:
    type: executive
    
  semantic_sources:
    - id: main
      type: cube
      endpoint: "https://cube.example.com/cubejs-api/v1"
      
  layout:
    type: grid
    columns: 12
    
  panels:
    - id: revenue
      type: kpi
      title: "Total Revenue"
      position:
        row: 0
        column: 0
        width: 4
        height: 2
      data:
        source: main
        metrics:
          - ref: "sales.total_revenue"
```

### B.2 Executive Sales Dashboard

See Section 6.2 for complete example.

### B.3 Analyst Exploration Dashboard

```yaml
uds: "0.1.0"

dashboard:
  title: "Sales Deep Dive"
  description: "Interactive exploration of sales data"
  intent: "Enable analysts to explore sales patterns and anomalies"
  
  persona:
    type: analyst
    
  decisions:
    - "Identify underperforming segments"
    - "Discover correlation between metrics"
    - "Generate hypotheses for further investigation"
    
  semantic_sources:
    - id: sales
      type: cube
      endpoint: "https://cube.example.com/cubejs-api/v1"
      
  time_context:
    default_range:
      preset: last_90_days
    timezone:
      mode: user_local
    comparison:
      enabled: true
      default: previous_period
      options:
        - previous_period
        - previous_year
    granularity:
      default: week
      options:
        - day
        - week
        - month
        
  layout:
    type: sections
    sections:
      - id: filters_section
        title: null
        layout:
          type: flow
          direction: horizontal
        panels:
          - filter_bar
          
      - id: overview
        title: "Overview"
        collapsible: true
        layout:
          type: grid
          columns: 12
        panels:
          - revenue_kpi
          - orders_kpi
          - aov_kpi
          - conversion_kpi
          - main_trend
          
      - id: breakdown
        title: "Breakdown Analysis"
        collapsible: true
        layout:
          type: grid
          columns: 12
        panels:
          - segment_comparison
          - correlation_scatter
          - detail_table
          
  panels:
    - id: filter_bar
      type: composite
      position:
        row: 0
        column: 0
        width: 12
        height: 1
      options:
        arrangement: flow
      data:
        source: sales
        
    - id: revenue_kpi
      type: kpi
      title: "Revenue"
      position:
        row: 0
        column: 0
        width: 3
        height: 2
      data:
        source: sales
        metrics:
          - ref: "sales.total_revenue"
        comparison: true
      options:
        format:
          style: currency
          currency: USD
          notation: compact
        comparison:
          enabled: true
        sparkline:
          enabled: true
          
    # Additional panels...
    
    - id: correlation_scatter
      type: scatter
      title: "Deal Size vs Win Rate"
      description: "Correlation between average deal size and win rate by segment"
      position:
        row: 0
        column: 0
        width: 6
        height: 4
      data:
        source: sales
        metrics:
          - ref: "sales.average_deal_size"
          - ref: "sales.win_rate"
        dimensions:
          - ref: "customer.segment"
      options:
        x_metric:
          ref: "sales.average_deal_size"
        y_metric:
          ref: "sales.win_rate"
        trend_line:
          enabled: true
          type: linear
          show_r_squared: true
        labels:
          show: true
          field: "customer.segment"
      interactions:
        - trigger: click
          action: filter
          dimension: "customer.segment"
          
    - id: detail_table
      type: table
      title: "Transaction Details"
      position:
        row: 1
        column: 0
        width: 12
        height: 5
      data:
        source: sales
        metrics:
          - ref: "sales.total_revenue"
          - ref: "sales.order_count"
          - ref: "sales.average_order_value"
        dimensions:
          - ref: "customer.name"
          - ref: "customer.segment"
          - ref: "geography.region"
        sort:
          - metric: "sales.total_revenue"
            direction: desc
        limit: 100
      options:
        columns:
          - field: "customer.name"
            header: "Customer"
            width: 200
            frozen: true
          - field: "customer.segment"
            header: "Segment"
            width: 120
          - field: "geography.region"
            header: "Region"
            width: 100
          - field: "sales.total_revenue"
            header: "Revenue"
            width: 120
            format:
              style: currency
              currency: USD
          - field: "sales.order_count"
            header: "Orders"
            width: 80
          - field: "sales.average_order_value"
            header: "AOV"
            width: 100
            format:
              style: currency
              currency: USD
        pagination:
          enabled: true
          page_size: 25
        search:
          enabled: true
        export:
          enabled: true
          formats:
            - csv
            - xlsx
            
  filters:
    - id: segment_filter
      dimension: "customer.segment"
      type: checkbox
      label: "Customer Segment"
      multi: true
      default: ["all"]
      
    - id: region_filter
      dimension: "geography.region"
      type: select
      label: "Region"
      multi: true
      
    - id: revenue_range
      dimension: "sales.total_revenue"
      type: range
      label: "Revenue Range"
      options:
        min: 0
        max: 10000000
        
  cross_filter:
    enabled: true
    mode: highlight
    
  theme:
    ref: "analyst-focused"
```

### B.4 AI Generation Request

```yaml
uds: "0.1.0"

dashboard:
  title: null                    # AI generates
  
  intent: "Help customer success team identify at-risk accounts"
  
  decisions:
    - "Which accounts need immediate outreach?"
    - "What signals indicate churn risk?"
    - "How should CSMs prioritise their time?"
    
  persona:
    type: custom
    id: "customer_success_manager"
    characteristics:
      attention_span: moderate
      data_literacy: medium
      interaction_preference: moderate
      primary_concern: "account_health"
      update_frequency: frequent
      
  semantic_sources:
    - id: customer
      type: cube
      endpoint: "https://cube.example.com/cubejs-api/v1"
      
  generation:
    mode: full
    
    constraints:
      max_panels: 6
      max_kpis: 4
      require_table: true
      
    candidate_metrics:
      - "accounts.health_score"
      - "accounts.churn_risk"
      - "accounts.nps_score"
      - "engagement.login_frequency"
      - "engagement.feature_adoption"
      - "engagement.support_tickets"
      - "revenue.mrr"
      - "revenue.expansion_revenue"
      - "revenue.contraction_revenue"
      
    required_metrics:
      - "accounts.churn_risk"
      - "accounts.health_score"
      
    candidate_dimensions:
      - "account.name"
      - "account.segment"
      - "account.csm"
      - "account.contract_end_date"
      - "time.month"
      
    preferences:
      chart_style: minimal
      enable_drill_down: true
      show_targets: true
      highlight_at_risk: true
      
    context:
      guidance: |
        - Prioritise accounts with contract renewals in next 90 days
        - Health score below 70 is considered at-risk
        - Include CSM assignment for action routing
        - Sort by urgency (combination of risk and contract date)
        
  # AI populates remaining fields
  time_context: null
  layout: null
  panels: null
  filters: null
```

---

## Appendix C: Migration Guides

### C.1 Grafana to UDS

```yaml
# Grafana Dashboard JSON (simplified)
{
  "title": "Sales Dashboard",
  "panels": [
    {
      "type": "stat",
      "title": "Revenue",
      "targets": [
        {
          "expr": "sum(revenue)",
          "refId": "A"
        }
      ],
      "gridPos": {"x": 0, "y": 0, "w": 6, "h": 4}
    }
  ]
}

# Equivalent UDS
uds: "0.1.0"

dashboard:
  title: "Sales Dashboard"
  intent: "[REQUIRED: Add dashboard purpose]"
  
  persona:
    type: analyst               # Default assumption
    
  semantic_sources:
    - id: primary
      type: custom
      endpoint: "[REQUIRED: Semantic layer endpoint]"
      capabilities:
        metrics: true
        dimensions: true
        filters: true
        time_grains: [day, week, month]
        
  layout:
    type: grid
    columns: 24                 # Grafana uses 24-column grid
    row_height: 30              # Grafana default
    
  panels:
    - id: panel_1
      type: kpi                 # Grafana 'stat' maps to UDS 'kpi'
      title: "Revenue"
      position:
        row: 0
        column: 0
        width: 6
        height: 4
      data:
        source: primary
        metrics:
          - ref: "revenue.total"  # Map from Prometheus query
```

### C.2 Metabase to UDS

Migration guide for Metabase questions and dashboards.

### C.3 Tableau to UDS

Migration guide for Tableau workbooks.

---

## Appendix D: Glossary

| Term | Definition |
|------|------------|
| **Bindings** | Mappings from semantic layer references to data roles required by goal-oriented panel types |
| **Conformant** | An implementation passing the UDS conformance test suite |
| **Dashboard** | A collection of panels presenting related analytical information |
| **Data Role** | A named slot in a goal-oriented panel type that must be filled by a semantic reference |
| **Dimension** | A categorical or temporal attribute used to segment metrics |
| **Disclosure** | The level of information density shown to the user |
| **Drill-down** | Navigation from summary to detail within a hierarchy |
| **Drill-through** | Navigation to a different dashboard with preserved context |
| **Goal-Oriented Type** | Panel types designed for objectives, targets, and progress tracking (progress, okr, scorecard, roadmap) |
| **Hybrid Data Binding** | Pattern combining standard data queries with role-based bindings for structured panel types |
| **Intent** | The declared purpose of a dashboard or panel |
| **Key Result** | A measurable outcome that indicates progress toward an objective (in OKR methodology) |
| **Metric** | A quantitative measurement defined in the semantic layer |
| **Objective** | A qualitative goal statement in OKR methodology |
| **OKR** | Objectives and Key Results - a goal-setting methodology |
| **Panel** | A single visualisation or content unit within a dashboard |
| **Persona** | A representation of the target user audience |
| **Perspective** | A category in balanced scorecard methodology (e.g., Financial, Customer, Internal, Learning) |
| **Progress** | The current state of advancement toward a target or goal |
| **Renderer** | Software that displays UDS documents visually |
| **Roadmap** | A timeline-based visualisation of phases, milestones, and initiatives |
| **Scorecard** | A categorised metrics display, often following balanced scorecard methodology |
| **Semantic Layer** | Business logic layer defining metrics and dimensions |
| **Semantic Reference** | A pointer to a metric or dimension in the semantic layer |
| **UDS** | Universal Dashboard Specification |

---


## Appendix E: Conformance Level Enumeration



This section defines which properties are required at each conformance level.

**Conformance Levels**:

- **Core**: Minimum viable implementation. Simple dashboards work.
- **Standard**: Production-ready. Most features supported.
- **Complete**: Full specification. All features supported.

### E.1 Legend

| Marker | Meaning |
|--------|---------|
|  | REQUIRED at this level |
|  | OPTIONAL at this level (may implement) |
|  | Not applicable at this level |

### E.2 Root Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `uds` |  |  |  | Version string |
| `$schema` |  |  |  | JSON Schema URI |
| `metadata` |  |  |  | Document metadata |
| `dashboard` |  |  |  | Dashboard definition |
| `extensions` |  |  |  | Must ignore unknown |

### E.3 Metadata Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `id` |  |  |  | Document identifier |
| `name` |  |  |  | Machine-readable name |
| `created_at` |  |  |  | Creation timestamp |
| `modified_at` |  |  |  | Last modification |
| `version` |  |  |  | Document version |
| `authors` |  |  |  | Author list |
| `tags` |  |  |  | Categorisation |
| `changelog` |  |  |  | Version history |
| `annotations` |  |  |  | Arbitrary metadata |

### E.4 Dashboard Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `title` |  |  |  | Dashboard title |
| `description` |  |  |  | Extended description |
| `intent` |  |  |  | Purpose declaration |
| `decisions` |  |  |  | Decision enablement |
| `persona` |  |  |  | Target audience |
| `semantic_sources` |  |  |  | Data connections |
| `time_context` |  |  |  | Time configuration |
| `layout` |  |  |  | Panel arrangement |
| `panels` |  |  |  | Content panels |
| `derived_metrics` |  |  |  | Computed metrics |
| `filters` |  |  |  | Global filters |
| `variables` |  |  |  | User variables |
| `refresh` |  |  |  | Auto-refresh |
| `access` |  |  |  | Access control |
| `alerts` |  |  |  | Alert definitions |
| `theme` |  |  |  | Theme config |
| `i18n` |  |  |  | Internationalisation |
| `embedding` |  |  |  | Embedding config |
| `error_handling` |  |  |  | Error behaviour |
| `lifecycle` |  |  |  | Document lifecycle |
| `generation` |  |  |  | AI generation |

### E.5 Persona Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `type` |  |  |  | Persona type |
| `id` |  |  |  | For custom type |
| `name` |  |  |  | For custom type |
| `characteristics` |  |  |  | Explicit characteristics |

**Persona Types**:

| Type | Core | Standard | Complete |
|------|------|----------|----------|
| `executive` |  |  |  |
| `manager` |  |  |  |
| `analyst` |  |  |  |
| `operator` |  |  |  |
| `external` |  |  |  |
| `custom` |  |  |  |

### E.6 Characteristics Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `attention_span` |  |  |  | brief/moderate/extended |
| `data_literacy` |  |  |  | low/medium/high |
| `interaction_preference` |  |  |  | minimal/moderate/full |
| `primary_device` |  |  |  | desktop/tablet/mobile/any |
| `primary_concern` |  |  |  | Domain-specific |
| `update_frequency` |  |  |  | How often checked |

### E.7 SemanticSource Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `id` |  |  |  | Source identifier |
| `type` |  |  |  | Source type |
| `endpoint` |  |  |  | API endpoint |
| `authentication` |  |  |  | Auth config |
| `capabilities` |  |  |  | For custom type |
| `options` |  |  |  | Type-specific options |

**Source Types**:

| Type | Core | Standard | Complete |
|------|------|----------|----------|
| `cube` |  |  |  |
| `dbt` |  |  |  |
| `looker` |  |  |  |
| `atscale` |  |  |  |
| `custom` |  |  |  |

### E.8 Authentication Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `type` |  |  |  | Auth type |
| `token_env` |  |  |  | Env var reference |
| `header_name` |  |  |  | Custom header |
| `oauth2` |  |  |  | OAuth2 config |

**Authentication Types**:

| Type | Core | Standard | Complete |
|------|------|----------|----------|
| `none` |  |  |  |
| `bearer` |  |  |  |
| `api_key` |  |  |  |
| `oauth2` |  |  |  |
| `custom` |  |  |  |

### E.9 Capabilities Object (Custom Sources)

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `metrics` |  |  |  | Supports metrics |
| `dimensions` |  |  |  | Supports dimensions |
| `filters` |  |  |  | Supports filters |
| `time_grains` |  |  |  | Supported granularities |
| `supports_comparison` |  |  |  | Period comparison |
| `supports_percentiles` |  |  |  | Percentile calcs |
| `supports_cumulative` |  |  |  | Running totals |
| `max_dimensions` |  |  |  | Dimension limit |
| `max_metrics` |  |  |  | Metric limit |
| `max_rows` |  |  |  | Row limit |

### E.10 TimeContext Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `default_range` |  |  |  | Default time selection |
| `timezone` |  |  |  | Timezone handling |
| `boundaries` |  |  |  | Period boundaries |
| `comparison` |  |  |  | Comparison settings |
| `granularity` |  |  |  | Granularity settings |
| `incomplete_periods` |  |  |  | Partial period handling |

### E.11 TimezoneConfig Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `mode` |  |  |  | Timezone mode |
| `explicit` |  |  |  | IANA timezone |
| `display_mode` |  |  |  | How to show timezone |

**Timezone Modes**:

| Mode | Core | Standard | Complete |
|------|------|----------|----------|
| `user_local` |  |  |  |
| `utc` |  |  |  |
| `explicit` |  |  |  |
| `source` |  |  |  |

### E.12 TimeRange Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `preset` |  |  |  | Preset identifier |
| `start` |  |  |  | Explicit start |
| `end` |  |  |  | Explicit end |
| `relative` |  |  |  | Relative range |

**Built-in Presets**:

| Preset | Core | Standard | Complete |
|--------|------|----------|----------|
| `today` |  |  |  |
| `yesterday` |  |  |  |
| `this_week` |  |  |  |
| `last_week` |  |  |  |
| `last_7_days` |  |  |  |
| `last_30_days` |  |  |  |
| `this_month` |  |  |  |
| `last_month` |  |  |  |
| `this_quarter` |  |  |  |
| `last_quarter` |  |  |  |
| `this_year` |  |  |  |
| `last_year` |  |  |  |
| `year_to_date` |  |  |  |
| `all_time` |  |  |  |
| `last_14_days` |  |  |  |
| `last_90_days` |  |  |  |
| `current_quarter` |  |  |  |
| `previous_quarter` |  |  |  |
| `quarter_to_date` |  |  |  |
| `month_to_date` |  |  |  |
| `week_to_date` |  |  |  |

### E.13 Boundaries Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `day_start` |  |  |  | Day boundary time |
| `week_start` |  |  |  | First day of week |
| `fiscal_year_start` |  |  |  | Fiscal year start |
| `fiscal_quarter_months` |  |  |  | Fiscal quarters |

### E.14 ComparisonConfig Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `enabled` |  |  |  | Enable comparison |
| `default` |  |  |  | Default type |
| `options` |  |  |  | Available options |
| `alignment` |  |  |  | Calendar/rolling |

**Comparison Types**:

| Type | Core | Standard | Complete |
|------|------|----------|----------|
| `previous_period` |  |  |  |
| `previous_year` |  |  |  |
| `previous_week` |  |  |  |
| `previous_month` |  |  |  |
| `previous_quarter` |  |  |  |
| `custom` |  |  |  |

### E.15 DataBinding Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `source` |  |  |  | Semantic source ID |
| `metrics` |  |  |  | Metrics to query |
| `dimensions` |  |  |  | Grouping dimensions |
| `filters` |  |  |  | Query filters |
| `sort` |  |  |  | Result ordering |
| `limit` |  |  |  | Maximum rows |
| `time_range` |  |  |  | Time range |
| `comparison` |  |  |  | Include comparison |

### E.16 MetricRef Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `ref` |  |  |  | Semantic reference |
| `alias` |  |  |  | Display name |
| `format` |  |  |  | Format override |
| `transform` |  |  |  | Post-query transform |

**Transforms**:

| Transform | Core | Standard | Complete |
|-----------|------|----------|----------|
| `running_total` |  |  |  |
| `percent_of_total` |  |  |  |
| `percent_of_group` |  |  |  |
| `rank` |  |  |  |
| `dense_rank` |  |  |  |
| `percentile` |  |  |  |
| `z_score` |  |  |  |
| `moving_average` |  |  |  |
| `period_over_period` |  |  |  |
| `year_over_year` |  |  |  |

### E.17 DimensionRef Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `ref` |  |  |  | Semantic reference |
| `alias` |  |  |  | Display name |
| `granularity` |  |  |  | Time granularity |
| `sort` |  |  |  | Sort order |
| `limit` |  |  |  | Top N values |
| `other` |  |  |  | Other handling |
| `bin` |  |  |  | Numeric binning |

### E.18 FilterExpression Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `dimension` |  |  |  | Dimension to filter |
| `metric` |  |  |  | Metric to filter |
| `operator` |  |  |  | Comparison operator |
| `value` |  |  |  | Single value |
| `values` |  |  |  | Multiple values |
| `expression` |  |  |  | Complex expression |

**Filter Operators**:

| Operator | Core | Standard | Complete |
|----------|------|----------|----------|
| `eq` |  |  |  |
| `neq` |  |  |  |
| `gt` |  |  |  |
| `gte` |  |  |  |
| `lt` |  |  |  |
| `lte` |  |  |  |
| `in` |  |  |  |
| `not_in` |  |  |  |
| `contains` |  |  |  |
| `not_contains` |  |  |  |
| `starts_with` |  |  |  |
| `ends_with` |  |  |  |
| `matches` |  |  |  |
| `is_null` |  |  |  |
| `is_not_null` |  |  |  |
| `between` |  |  |  |
| `not_between` |  |  |  |

### E.19 DerivedMetric Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `id` |  |  |  | Unique identifier |
| `name` |  |  |  | Display name |
| `description` |  |  |  | Description |
| `expression` |  |  |  | Calculation |
| `format` |  |  |  | Display format |

**Expression Types**:

| Type | Core | Standard | Complete |
|------|------|----------|----------|
| `arithmetic` |  |  |  |
| `conditional` |  |  |  |
| `window` |  |  |  |
| `case` |  |  |  |

### E.20 Layout Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `type` |  |  |  | Layout type |
| `columns` |  |  |  | Grid columns |
| `row_height` |  |  |  | Base row height |
| `gap` |  |  |  | Panel gap |
| `padding` |  |  |  | Container padding |
| `max_width` |  |  |  | Maximum width |
| `breakpoints` |  |  |  | Responsive breakpoints |
| `sections` |  |  |  | For sections type |
| `tabs` |  |  |  | For tabs type |

**Layout Types**:

| Type | Core | Standard | Complete |
|------|------|----------|----------|
| `grid` |  |  |  |
| `sections` |  |  |  |
| `tabs` |  |  |  |
| `flow` |  |  |  |

### E.21 Position Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `row` |  |  |  | Grid row |
| `column` |  |  |  | Grid column |
| `width` |  |  |  | Column span |
| `height` |  |  |  | Row span |
| `z_index` |  |  |  | Stacking order |
| `responsive` |  |  |  | Responsive overrides |

### E.22 Panel Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `id` |  |  |  | Panel identifier |
| `type` |  |  |  | Visualisation type |
| `title` |  |  |  | Panel title |
| `description` |  |  |  | Extended description |
| `position` |  |  |  | Grid position |
| `data` |  |  |  | Data binding |
| `options` |  |  |  | Type-specific options |
| `disclosure` |  |  |  | Info density levels |
| `interactions` |  |  |  | User interactions |
| `conditional` |  |  |  | Conditional display |
| `error_handling` |  |  |  | Error behaviour |
| `accessibility` |  |  |  | A11y overrides |
| `cache` |  |  |  | Caching config |

### E.23 Panel Types

| Type | Category | Core | Standard | Complete |
|------|----------|------|----------|----------|
| `kpi` | Core |  |  |  |
| `trend` | Core |  |  |  |
| `bar` | Core |  |  |  |
| `table` | Core |  |  |  |
| `pie` | Core |  |  |  |
| `text` | Core |  |  |  |
| `progress` | Core |  |  |  |
| `scatter` | Extended |  |  |  |
| `heatmap` | Extended |  |  |  |
| `funnel` | Extended |  |  |  |
| `gauge` | Extended |  |  |  |
| `map` | Extended |  |  |  |
| `treemap` | Extended |  |  |  |
| `sankey` | Extended |  |  |  |
| `histogram` | Extended |  |  |  |
| `waterfall` | Extended |  |  |  |
| `bullet` | Extended |  |  |  |
| `sparkline` | Extended |  |  |  |
| `okr` | Extended (Goal) |  |  |  |
| `scorecard` | Extended (Goal) |  |  |  |
| `roadmap` | Extended (Goal) |  |  |  |
| `auto` | Special |  |  |  |
| `composite` | Special |  |  |  |
| `custom` | Special |  |  |  |

### E.24 KPI Options

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `format` |  |  |  | Value format |
| `comparison` |  |  |  | Comparison config |
| `sparkline` |  |  |  | Sparkline config |
| `target` |  |  |  | Target config |
| `thresholds` |  |  |  | Status thresholds |
| `layout` |  |  |  | Layout options |

### E.25 Trend Options

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `style` |  |  |  | line/area/bar/etc |
| `series` |  |  |  | Series config |
| `x_axis` |  |  |  | X-axis config |
| `y_axis` |  |  |  | Y-axis config |
| `y_axis_secondary` |  |  |  | Dual axis |
| `reference_lines` |  |  |  | Reference lines |
| `annotations` |  |  |  | Annotations |
| `comparison` |  |  |  | Comparison overlay |
| `legend` |  |  |  | Legend config |
| `tooltip` |  |  |  | Tooltip config |
| `zoom` |  |  |  | Zoom config |
| `pan` |  |  |  | Pan config |

### E.26 Bar Options

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `orientation` |  |  |  | vertical/horizontal |
| `mode` |  |  |  | grouped/stacked/etc |
| `bar` |  |  |  | Bar styling |
| `sort` |  |  |  | Sorting |
| `labels` |  |  |  | Value labels |
| `x_axis` |  |  |  | X-axis config |
| `y_axis` |  |  |  | Y-axis config |
| `reference_lines` |  |  |  | Reference lines |
| `legend` |  |  |  | Legend config |
| `comparison` |  |  |  | Comparison |

### E.27 Table Options

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `columns` |  |  |  | Column definitions |
| `default_sort` |  |  |  | Default sort |
| `pagination` |  |  |  | Pagination config |
| `row` |  |  |  | Row config |
| `header` |  |  |  | Header config |
| `footer` |  |  |  | Footer/aggregations |
| `export` |  |  |  | Export options |
| `search` |  |  |  | Search config |
| `column_visibility` |  |  |  | Show/hide columns |

### E.28 Pie Options

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `variant` |  |  |  | pie/donut/semi |
| `donut` |  |  |  | Donut config |
| `segments` |  |  |  | Segment config |
| `sort` |  |  |  | Sorting |
| `labels` |  |  |  | Label config |
| `legend` |  |  |  | Legend config |
| `max_segments` |  |  |  | Limit segments |

### E.29 Text Options

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `content` |  |  |  | Content config |
| `dynamic` |  |  |  | Dynamic content |
| `padding` |  |  |  | Padding |
| `background` |  |  |  | Background |
| `border` |  |  |  | Border |

### E.30 Progress Options

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `metric` |  |  |  | Current value |
| `target` |  |  |  | Target config |
| `start` |  |  |  | Start value |
| `milestones` |  |  |  | Milestones |
| `display` |  |  |  | Display config |
| `status` |  |  |  | Status thresholds |
| `time_context` |  |  |  | Time bounds |

### E.31 OKR Options

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `bindings` |  |  |  | Data role bindings |
| `structure` |  |  |  | Hierarchy config |
| `display` |  |  |  | Display options |
| `scoring` |  |  |  | Score calculation |
| `status_thresholds` |  |  |  | Status determination |
| `period` |  |  |  | Period selector |
| `grouping` |  |  |  | Group by attribute |

### E.32 Scorecard Options

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `bindings` |  |  |  | Data role bindings |
| `perspectives` |  |  |  | Static perspectives |
| `display` |  |  |  | Display options |
| `scoring` |  |  |  | Score calculation |
| `status_thresholds` |  |  |  | Status determination |

### E.33 Roadmap Options

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `bindings` |  |  |  | Data role bindings |
| `timeline` |  |  |  | Timeline config |
| `display` |  |  |  | Display options |
| `lanes` |  |  |  | Swim lanes |
| `dependencies` |  |  |  | Dependency display |
| `today_marker` |  |  |  | Current date |

### E.34 Interaction Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `trigger` |  |  |  | User action |
| `action` |  |  |  | Resulting action |
| `target` |  |  |  | Action target |
| `context` |  |  |  | Context to pass |
| `condition` |  |  |  | Conditional execution |

**Triggers**:

| Trigger | Core | Standard | Complete |
|---------|------|----------|----------|
| `click` |  |  |  |
| `double_click` |  |  |  |
| `right_click` |  |  |  |
| `hover` |  |  |  |
| `focus` |  |  |  |
| `context_menu` |  |  |  |

**Actions**:

| Action | Core | Standard | Complete |
|--------|------|----------|----------|
| `drill_down` |  |  |  |
| `drill_through` |  |  |  |
| `filter` |  |  |  |
| `highlight` |  |  |  |
| `tooltip` |  |  |  |
| `export` |  |  |  |
| `external_link` |  |  |  |
| `copy` |  |  |  |
| `custom` |  |  |  |

### E.35 Filter Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `id` |  |  |  | Filter identifier |
| `dimension` |  |  |  | Dimension to filter |
| `type` |  |  |  | Filter UI type |
| `label` |  |  |  | Display label |
| `default` |  |  |  | Default value |
| `required` |  |  |  | Must select |
| `multi` |  |  |  | Multiple selection |
| `options` |  |  |  | Type-specific options |

**Filter Types**:

| Type | Core | Standard | Complete |
|------|------|----------|----------|
| `select` |  |  |  |
| `search` |  |  |  |
| `checkbox` |  |  |  |
| `radio` |  |  |  |
| `toggle` |  |  |  |
| `range` |  |  |  |
| `date_range` |  |  |  |
| `tree` |  |  |  |
| `input` |  |  |  |

### E.36 Variable Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `id` |  |  |  | Variable identifier |
| `type` |  |  |  | Variable type |
| `label` |  |  |  | Display label |
| `default` |  |  |  | Default value |
| `description` |  |  |  | Help text |
| `options` |  |  |  | Type-specific options |

### E.37 Theme Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `ref` |  |  |  | External reference |
| `base` |  |  |  | Base theme |
| `colors` |  |  |  | Color definitions |
| `typography` |  |  |  | Typography |
| `spacing` |  |  |  | Spacing scale |
| `borders` |  |  |  | Border styles |
| `shadows` |  |  |  | Shadow styles |
| `motion` |  |  |  | Animation config |
| `charts` |  |  |  | Chart theming |

### E.38 I18n Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `default_locale` |  |  |  | Default locale |
| `supported_locales` |  |  |  | Available locales |
| `fallback_locale` |  |  |  | Fallback |
| `translations` |  |  |  | String translations |
| `formatting` |  |  |  | Locale formatting |
| `rtl_locales` |  |  |  | RTL languages |

### E.39 Access Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `visibility` |  |  |  | Public/auth/restricted |
| `owner` |  |  |  | Owner identifier |
| `inherit_rls` |  |  |  | Inherit from semantic |
| `roles` |  |  |  | Role-based rules |
| `panel_access` |  |  |  | Panel-level access |
| `data_masking` |  |  |  | Field masking |
| `export_restrictions` |  |  |  | Export limits |

### E.40 Alert Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `id` |  |  |  | Alert identifier |
| `name` |  |  |  | Alert name |
| `description` |  |  |  | Description |
| `enabled` |  |  |  | Enable/disable |
| `condition` |  |  |  | Trigger condition |
| `severity` |  |  |  | Alert severity |
| `notifications` |  |  |  | Channels |
| `schedule` |  |  |  | Check schedule |
| `cooldown` |  |  |  | Re-alert delay |
| `auto_resolve` |  |  |  | Auto-resolve |

### E.41 Embedding Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `enabled` |  |  |  | Allow embedding |
| `authentication` |  |  |  | Auth config |
| `allowed_origins` |  |  |  | Origin allowlist |
| `styling` |  |  |  | Style inheritance |
| `events` |  |  |  | Event communication |
| `sandbox` |  |  |  | Security sandbox |
| `responsive` |  |  |  | Responsive behaviour |

### E.42 ErrorHandling Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `source_unavailable` |  |  |  | Source error |
| `authentication_failed` |  |  |  | Auth error |
| `query_failed` |  |  |  | Query error |
| `timeout` |  |  |  | Timeout |
| `empty_data` |  |  |  | No data |
| `partial_failure` |  |  |  | Partial error |
| `global_fallback` |  |  |  | Default behaviour |

### E.43 Lifecycle Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `status` |  |  |  | Current status |
| `created_at` |  |  |  | Creation time |
| `created_by` |  |  |  | Creator |
| `published_at` |  |  |  | Publication time |
| `published_by` |  |  |  | Publisher |
| `deprecated_at` |  |  |  | Deprecation time |
| `sunset_at` |  |  |  | EOL date |
| `replacement` |  |  |  | Replacement ID |
| `migration_guide` |  |  |  | Migration URL |
| `review` |  |  |  | Review workflow |
| `variants` |  |  |  | A/B variants |

### E.44 Generation Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `mode` |  |  |  | Generation mode |
| `model` |  |  |  | AI model |
| `constraints` |  |  |  | Hard constraints |
| `preferences` |  |  |  | Soft preferences |
| `candidate_metrics` |  |  |  | Metrics to consider |
| `required_metrics` |  |  |  | Required metrics |
| `excluded_metrics` |  |  |  | Excluded metrics |
| `candidate_dimensions` |  |  |  | Dimensions to consider |
| `required_dimensions` |  |  |  | Required dimensions |
| `context` |  |  |  | Additional context |

### E.45 Format Object

| Property | Core | Standard | Complete | Notes |
|----------|------|----------|----------|-------|
| `style` |  |  |  | number/currency/percent/etc |
| `currency` |  |  |  | ISO 4217 code |
| `precision` |  |  |  | Decimal places |
| `notation` |  |  |  | standard/compact/etc |
| `sign_display` |  |  |  | Sign display |
| `prefix` |  |  |  | Custom prefix |
| `suffix` |  |  |  | Custom suffix |

---

## 3.46 Conformance Test Counts

Based on the enumeration above:

| Level | Required Properties | Optional Properties | Total Tests (Est.) |
|-------|--------------------|--------------------|-------------------|
| **Core** | 127 | 43 | 470 |
| **Standard** | 298 | 156 | 940 |
| **Complete** | 412 | 0 | 1,520 |

**Note**: Test counts include validation tests, rendering tests, and edge case tests for each property.

---


---

## Acknowledgements

This specification was developed with input from:

- The open-source dashboard community
- Semantic layer vendors and practitioners
- Accessibility experts
- Enterprise analytics teams

---

## Authors

- Tortoise AI Ltd

---

## Document History

| Version | Date | Changes |
|---------|------|---------|
| 0.1.0 | 2026-01 | Initial release |

---

*End of Universal Dashboard Specification v0.1.0*
